{
  this._player=p;
  _rand=new Random(seed.hashCode());
  _pGen1=new PerlinNoise(_rand.nextInt());
  _pGen2=new PerlinNoise(_rand.nextInt());
  _pGen3=new PerlinNoise(_rand.nextInt());
  final World currentWorld=this;
  _chunks=new Chunk[(int)Configuration._viewingDistanceInChunks.x][(int)Configuration._viewingDistanceInChunks.y][(int)Configuration._viewingDistanceInChunks.z];
  _updateThread=new Thread(new Runnable(){
    @Override public void run(){
      long timeStart=System.currentTimeMillis();
      Logger.getLogger(this.getClass().getName()).log(Level.INFO,"Generating chunks. Please wait.");
      for (int x=0; x < Configuration._viewingDistanceInChunks.x; x++) {
        for (int y=0; y < Configuration._viewingDistanceInChunks.y; y++) {
          for (int z=0; z < Configuration._viewingDistanceInChunks.z; z++) {
            Chunk c=new Chunk(currentWorld,new Vector3f(x,y,z));
            _chunks[x][y][z]=c;
            c.generate();
            c.populate();
            c.calcSunlight();
            queueChunkForUpdate(c);
          }
        }
      }
      _worldGenerated=true;
      _player.resetPlayer();
      Logger.getLogger(this.getClass().getName()).log(Level.INFO,"World updated ({0}s).",(System.currentTimeMillis() - timeStart) / 1000d);
      while (true) {
        Chunk c=null;
        if (_chunkUpdateQueueLight.size() == 0) {
synchronized (_chunkUpdateQueueDL) {
            c=_chunkUpdateQueue.peek();
            if (_chunkUpdateQueueDL.contains(c)) {
              c=null;
            }
 else {
              _chunkUpdateQueue.poll();
            }
          }
          if (c != null) {
            c.generateVertexArray();
synchronized (_chunkUpdateQueueDL) {
              _chunkUpdateQueueDL.add(c);
            }
          }
        }
 else {
synchronized (_chunkUpdateQueueDL) {
            c=_chunkUpdateQueueLight.poll();
          }
          if (c != null) {
            c.calcLight();
synchronized (_chunkUpdateQueueDL) {
              _chunkUpdateQueue.add(c);
            }
          }
        }
      }
    }
  }
);
  _worldThread=new Thread(new Runnable(){
    @Override public void run(){
      while (true) {
        updateInfWorld();
        if (Helper.getInstance().getTime() - _daylightTimer > 120000) {
          _daylight-=0.2;
          if (_daylight <= 0.4f) {
            _daylight=1.0f;
          }
          _daylightTimer=Helper.getInstance().getTime();
          updateAllChunks();
        }
      }
    }
  }
);
}
