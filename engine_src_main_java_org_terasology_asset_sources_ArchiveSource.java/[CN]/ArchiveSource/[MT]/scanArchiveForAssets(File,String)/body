{
  ZipFile archive;
  if (file.getName().endsWith(".jar")) {
    archive=new JarFile(file,false);
  }
 else {
    archive=new ZipFile(file);
  }
  try {
    Enumeration<? extends ZipEntry> lister=archive.entries();
    while (lister.hasMoreElements()) {
      ZipEntry entry=lister.nextElement();
      String entryPath=entry.getName();
      logger.debug("Found {}",entryPath);
      if (entryPath.startsWith(assetsPath)) {
        String key=entryPath.substring(assetsPath.length() + 1);
        AssetUri uri=getUri(key);
        if (uri == null || !uri.isValid()) {
          continue;
        }
        logger.debug("Discovered resource {}",uri);
        URL url=new URL("jar:file:" + file.getAbsolutePath() + "!/"+ entryPath);
        addItem(uri,url);
      }
    }
  }
  finally {
    archive.close();
  }
}
