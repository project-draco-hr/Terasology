{
  this.shadowMap=context.get(FrameBuffersManager.class).getFBO("sceneShadowMap");
  Vector3f lightPosition=new Vector3f(playerCamera.getPosition().x,0.0f,playerCamera.getPosition().z);
  float texelSize=1.0f / renderingConfig.getShadowMapResolution();
  texelSize*=2.0f;
  camera.getViewProjectionMatrix().transformPoint(lightPosition);
  lightPosition.set(TeraMath.fastFloor(lightPosition.x / texelSize) * texelSize,0.0f,TeraMath.fastFloor(lightPosition.z / texelSize) * texelSize);
  camera.getInverseViewProjectionMatrix().transformPoint(lightPosition);
  float stepSize=50f;
  Vector3f sunDirection=backdropProvider.getQuantizedSunDirection(stepSize);
  Vector3f sunPosition=new Vector3f(sunDirection);
  sunPosition.scale(256.0f + 64.0f);
  lightPosition.add(sunPosition);
  camera.getPosition().set(lightPosition);
  Vector3f negSunDirection=new Vector3f(sunDirection);
  negSunDirection.scale(-1.0f);
  camera.getViewingDirection().set(negSunDirection);
  camera.update(deltaInSeconds);
}
