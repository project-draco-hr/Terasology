{
  ChunkImpl main=new ChunkImpl(new Vector3i(0,0,0));
  main.setChunkState(ChunkImpl.State.COMPLETE);
  for (  Vector3i pos : ChunkConstants.CHUNK_REGION) {
    main.setSunlight(pos,(byte)15);
  }
  ChunkImpl adjacent=new ChunkImpl(new Vector3i(1,0,0));
  adjacent.setChunkState(ChunkImpl.State.COMPLETE);
  for (  Vector3i pos : TeraMath.getEdgeRegion(ChunkConstants.CHUNK_REGION,Side.TOP)) {
    adjacent.setBlock(pos,solid);
  }
  ChunkProvider provider=mock(ChunkProvider.class);
  when(provider.getChunk(Vector3i.zero())).thenReturn(main);
  when(provider.getChunk(new Vector3i(1,0,0))).thenReturn(adjacent);
  BatchPropagator prop=new BatchPropagator(new SunlightPropagationRules(),new SunlightWorldView(provider));
  prop.propagateBetween(main,adjacent,Side.RIGHT);
  prop.process();
  assertEquals(14,adjacent.getSunlight(0,32,32));
  assertEquals(13,adjacent.getSunlight(1,32,32));
}
