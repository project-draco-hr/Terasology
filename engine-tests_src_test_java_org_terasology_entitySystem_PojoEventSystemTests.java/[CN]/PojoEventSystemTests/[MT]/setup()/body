{
  CoreRegistry.setContext(new ContextImpl());
  ReflectFactory reflectFactory=new ReflectionReflectFactory();
  CopyStrategyLibrary copyStrategies=new CopyStrategyLibrary(reflectFactory);
  TypeSerializationLibrary serializationLibrary=new TypeSerializationLibrary(reflectFactory,copyStrategies);
  EntitySystemLibrary entitySystemLibrary=new EntitySystemLibrary(reflectFactory,copyStrategies,serializationLibrary);
  compLibrary=entitySystemLibrary.getComponentLibrary();
  entityManager=new PojoEntityManager();
  entityManager.setComponentLibrary(entitySystemLibrary.getComponentLibrary());
  entityManager.setPrefabManager(new PojoPrefabManager());
  NetworkSystem networkSystem=mock(NetworkSystem.class);
  when(networkSystem.getMode()).thenReturn(NetworkMode.NONE);
  eventSystem=new EventSystemImpl(entitySystemLibrary.getEventLibrary(),networkSystem);
  entityManager.setEventSystem(eventSystem);
  entity=entityManager.create();
}
