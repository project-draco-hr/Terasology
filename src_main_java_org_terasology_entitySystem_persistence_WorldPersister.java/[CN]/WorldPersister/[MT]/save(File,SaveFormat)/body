{
  final EntityData.World world=persisterHelper.serializeWorld();
  File parentFile=file.getParentFile();
  if (parentFile != null) {
    if (!parentFile.exists()) {
      if (!parentFile.mkdirs()) {
        logger.error("Failed to create world save directory {}",parentFile);
      }
    }
  }
  FileOutputStream out=new FileOutputStream(file);
  try {
    format.save(out,world);
  }
  finally {
    try {
      out.close();
    }
 catch (    IOException e) {
      logger.error("Failed to close file",e);
    }
  }
}
