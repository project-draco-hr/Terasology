{
  if (element == null) {
    return sizeHint;
  }
  String family=(element.getFamily() != null) ? element.getFamily() : state.family;
  UIStyle elementStyle=state.skin.getStyleFor(family,element.getClass(),element.getMode());
  Rect2i adjustedArea=applySizesToRegion(Rect2i.createFromMinAndSize(Vector2i.zero(),sizeHint),elementStyle);
  try (SubRegion ignored=subRegionForWidget(element,adjustedArea,false)){
    Vector2i preferredSize=element.calcContentSize(this,elementStyle.getMargin().shrink(adjustedArea.size()));
    preferredSize=elementStyle.getMargin().grow(preferredSize);
    return applySizesToRegion(Rect2i.createFromMinAndSize(Vector2i.zero(),preferredSize),elementStyle).size();
  }
 }
