{
  mockTimer=mock(Timer.class);
  networkSystem=new NetworkSystemImpl(mockTimer);
  entityManager=new EntitySystemBuilder().build(CoreRegistry.get(ModManager.class),networkSystem);
  CoreRegistry.put(ComponentSystemManager.class,new ComponentSystemManager());
  CoreRegistry.put(BlockManager.class,new BlockManagerImpl());
  entityManager.clear();
  client=mock(NetClient.class);
  NetworkComponent clientNetComp=new NetworkComponent();
  clientNetComp.replicateMode=NetworkComponent.ReplicateMode.OWNER;
  clientEntity=entityManager.create(clientNetComp);
  when(client.getEntity()).thenReturn(clientEntity);
  networkSystem.mockHost();
  networkSystem.connectToEntitySystem(entityManager,CoreRegistry.get(EntitySystemLibrary.class),mock(BlockEntityRegistry.class));
  networkSystem.registerNetworkEntity(clientEntity);
}
