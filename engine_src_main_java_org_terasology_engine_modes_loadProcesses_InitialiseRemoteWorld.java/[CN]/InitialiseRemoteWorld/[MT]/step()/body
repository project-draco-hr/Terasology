{
  CoreRegistry.put(LocalPlayer.class,new LocalPlayer());
  BlockManager blockManager=CoreRegistry.get(BlockManager.class);
  RemoteChunkProvider chunkProvider=new RemoteChunkProvider(blockManager);
  WorldProviderCoreImpl worldProviderCore=new WorldProviderCoreImpl(gameManifest.getWorldInfo(TerasologyConstants.MAIN_WORLD),chunkProvider,blockManager.getBlock(BlockManager.AIR_ID));
  EntityAwareWorldProvider entityWorldProvider=new EntityAwareWorldProvider(worldProviderCore);
  WorldProvider worldProvider=new WorldProviderWrapper(entityWorldProvider);
  CoreRegistry.put(WorldProvider.class,worldProvider);
  CoreRegistry.put(BlockEntityRegistry.class,entityWorldProvider);
  CoreRegistry.get(ComponentSystemManager.class).register(entityWorldProvider,"engine:BlockEntityRegistry");
  DefaultCelestialSystem celestialSystem=new DefaultCelestialSystem(new BasicCelestialModel());
  CoreRegistry.put(CelestialSystem.class,celestialSystem);
  CoreRegistry.get(ComponentSystemManager.class).register(celestialSystem);
  Skysphere skysphere=new Skysphere();
  BackdropProvider backdropProvider=skysphere;
  BackdropRenderer backdropRenderer=skysphere;
  CoreRegistry.put(BackdropProvider.class,backdropProvider);
  CoreRegistry.put(BackdropRenderer.class,backdropRenderer);
  RenderingSubsystemFactory engineSubsystemFactory=CoreRegistry.get(RenderingSubsystemFactory.class);
  WorldRenderer worldRenderer=engineSubsystemFactory.createWorldRenderer(backdropProvider,backdropRenderer,worldProvider,chunkProvider,CoreRegistry.get(LocalPlayerSystem.class));
  float reflectionHeight=CoreRegistry.get(NetworkSystem.class).getServer().getInfo().getReflectionHeight();
  worldRenderer.getActiveCamera().setReflectionHeight(reflectionHeight);
  CoreRegistry.put(WorldRenderer.class,worldRenderer);
  CoreRegistry.put(Camera.class,worldRenderer.getActiveCamera());
  CoreRegistry.get(NetworkSystem.class).setRemoteWorldProvider(chunkProvider);
  return true;
}
