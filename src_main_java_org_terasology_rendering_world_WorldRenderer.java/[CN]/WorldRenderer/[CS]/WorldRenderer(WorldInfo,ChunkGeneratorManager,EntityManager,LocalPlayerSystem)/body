{
  File f=new File(PathManager.getInstance().getWorldSavePath(worldInfo.getTitle()),worldInfo.getTitle() + ".dat");
  if (f.exists()) {
    try {
      chunkStore=loadChunkStore(f);
    }
 catch (    IOException e) {
      e.printStackTrace();
    }
  }
  if (chunkStore == null) {
    chunkStore=new ChunkStoreProtobuf();
  }
  _chunkProvider=new LocalChunkProvider(chunkStore,chunkGeneratorManager);
  EntityAwareWorldProvider entityWorldProvider=new EntityAwareWorldProvider(new WorldProviderCoreImpl(worldInfo,_chunkProvider));
  CoreRegistry.put(BlockEntityRegistry.class,entityWorldProvider);
  CoreRegistry.get(ComponentSystemManager.class).register(entityWorldProvider,"engine:BlockEntityRegistry");
  _worldProvider=new WorldProviderWrapper(entityWorldProvider);
  _bulletPhysics=new BulletPhysics(_worldProvider);
  _chunkTesselator=new ChunkTessellator(_worldProvider.getBiomeProvider());
  _skysphere=new Skysphere(this);
  _chunkUpdateManager=new ChunkUpdateManager(_chunkTesselator,_worldProvider);
  _worldTimeEventManager=new WorldTimeEventManager(_worldProvider);
  _blockGrid=new BlockGrid();
  localPlayerSystem.setPlayerCamera(_defaultCamera);
  _systemManager=CoreRegistry.get(ComponentSystemManager.class);
  initTimeEvents();
}
