{
  int newChunkPosX=calcCamChunkOffsetX();
  int newChunkPosZ=calcCamChunkOffsetZ();
  int viewingDistance=config.getRendering().getActiveViewingDistance();
  if (chunkPosX != newChunkPosX || chunkPosZ != newChunkPosZ || force || pendingChunks) {
    if (chunksInProximity.size() == 0 || force || pendingChunks) {
      chunksInProximity.clear();
      for (int x=-(viewingDistance / 2); x < viewingDistance / 2; x++) {
        for (int z=-(viewingDistance / 2); z < viewingDistance / 2; z++) {
          Chunk c=chunkProvider.getChunk(newChunkPosX + x,0,newChunkPosZ + z);
          if (c != null && c.getChunkState() == Chunk.State.COMPLETE && worldProvider.getLocalView(c.getPos()) != null) {
            chunksInProximity.add(c);
          }
 else {
            pendingChunks=true;
          }
        }
      }
    }
 else {
      int vd2=viewingDistance / 2;
      Rect2i oldView=new Rect2i(chunkPosX - vd2,chunkPosZ - vd2,viewingDistance,viewingDistance);
      Rect2i newView=new Rect2i(newChunkPosX - vd2,newChunkPosZ - vd2,viewingDistance,viewingDistance);
      List<Rect2i> removeRects=Rect2i.subtractEqualsSized(oldView,newView);
      for (      Rect2i r : removeRects) {
        for (int x=r.minX(); x < r.maxX(); ++x) {
          for (int y=r.minY(); y < r.maxY(); ++y) {
            Chunk c=chunkProvider.getChunk(x,0,y);
            chunksInProximity.remove(c);
          }
        }
      }
      List<Rect2i> addRects=Rect2i.subtractEqualsSized(newView,oldView);
      for (      Rect2i r : addRects) {
        for (int x=r.minX(); x < r.maxX(); ++x) {
          for (int y=r.minY(); y < r.maxY(); ++y) {
            Chunk c=chunkProvider.getChunk(x,0,y);
            if (c != null && c.getChunkState() == Chunk.State.COMPLETE && worldProvider.getLocalView(c.getPos()) != null) {
              chunksInProximity.add(c);
            }
 else {
              pendingChunks=true;
            }
          }
        }
      }
    }
    chunkPosX=newChunkPosX;
    chunkPosZ=newChunkPosZ;
    Collections.sort(chunksInProximity,new ChunkProximityComparator());
    return true;
  }
  return false;
}
