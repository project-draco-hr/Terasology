{
  if (client instanceof NetClient) {
    NetClient netClient=(NetClient)client;
    netClientList.remove(netClient);
  }
  clientList.remove(client);
  clientPlayerLookup.remove(client.getEntity());
  logger.info("Client disconnected: " + client.getName());
  PlayerEntityStore playerStore=new PlayerEntityStore(client.getId(),entityManager);
  playerStore.beginStore();
  client.getEntity().send(new DisconnectedEvent(playerStore));
  try {
    playerStore.endStore();
  }
 catch (  IOException e) {
    logger.error("Failed to store player data for '{}'",client.getId(),e);
  }
  client.disconnect();
}
