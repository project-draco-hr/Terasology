{
  ListMultimap<String,Class<? extends T>> result=ArrayListMultimap.create();
  List<Class<? extends T>> validSuperTypes=Lists.newArrayList();
  validSuperTypes.add(type);
  for (  Module module : getActiveModulesOrderedByDependency()) {
    List<Class<? extends T>> moduleTypes=Lists.newArrayList();
    for (    Class<? extends T> superType : validSuperTypes) {
      for (      Class<? extends T> subtype : module.getReflections().getSubTypesOf(superType)) {
        moduleTypes.add(subtype);
      }
    }
    result.putAll(module.getId(),moduleTypes);
    for (    Class<? extends T> moduleType : moduleTypes) {
      if (!Modifier.isFinal(moduleType.getModifiers())) {
        validSuperTypes.add(moduleType);
      }
    }
  }
  return result;
}
