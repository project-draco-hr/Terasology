{
  for (  DependencyInfo info : module.getModuleInfo().getDependencies()) {
    Module dependency=getLatestModuleVersion(info.getId());
    if (info.getMaxVersion().compareTo(dependency.getVersion()) <= 0) {
      enableModuleAndDependencies(dependency);
    }
  }
  Module oldModule=activeModules.put(module.getId(),module);
  if (!module.equals(oldModule)) {
    if (oldModule != null && oldModule instanceof ExtensionModule) {
      ((ExtensionModule)oldModule).disable();
    }
    if (module instanceof ExtensionModule) {
      ((ExtensionModule)module).enable();
    }
  }
}
