{
  JsonObject parentObj=blockDefJson;
  while (parentObj.has("basedOn")) {
    AssetUri parentUri=new AssetUri(AssetType.BLOCK_DEFINITION,parentObj.get("basedOn").getAsString());
    if (rootAssetUri.equals(parentUri)) {
      logger.error("Circular inheritance detected in {}",rootAssetUri);
      break;
    }
 else     if (!parentUri.isValid()) {
      logger.error("{} based on invalid uri: {}",rootAssetUri,parentObj.get("basedOn").getAsString());
      break;
    }
    JsonObject parent=readJson(parentUri).getAsJsonObject();
    JsonMergeUtil.mergeOnto(parent,blockDefJson);
    parentObj=parent;
  }
  return blockDefJson;
}
