{
  Map<Side,Block> blockMap=Maps.newEnumMap(Side.class);
  String[] categories=new String[0];
  if (blockDefJson.has("top")) {
    JsonObject topDefJson=blockDefJson.getAsJsonObject("top");
    blockDefJson.remove("top");
    mergeJsonInto(blockDefJson,topDefJson);
    BlockDefinition topDef=loadBlockDefinition(topDefJson);
    Block block=constructSingleBlock(blockDefUri,topDef);
    block.setDirection(Side.TOP);
    blockMap.put(Side.TOP,block);
    categories=getCategories(topDef);
  }
  if (blockDefJson.has("sides")) {
    JsonObject sideDefJson=blockDefJson.getAsJsonObject("sides");
    blockDefJson.remove("sides");
    mergeJsonInto(blockDefJson,sideDefJson);
    BlockDefinition sideDef=loadBlockDefinition(sideDefJson);
    constructHorizontalBlocks(blockDefUri,sideDef,blockMap);
    categories=getCategories(sideDef);
  }
  if (blockDefJson.has("bottom")) {
    JsonObject bottomDefJson=blockDefJson.getAsJsonObject("bottom");
    blockDefJson.remove("bottom");
    mergeJsonInto(blockDefJson,bottomDefJson);
    BlockDefinition bottomDef=loadBlockDefinition(bottomDefJson);
    Block block=constructSingleBlock(blockDefUri,bottomDef);
    block.setDirection(Side.BOTTOM);
    blockMap.put(Side.BOTTOM,block);
    categories=getCategories(bottomDef);
  }
  return new AlignToSurfaceFamily(new BlockUri(blockDefUri.getPackage(),blockDefUri.getAssetName()),blockMap,categories);
}
