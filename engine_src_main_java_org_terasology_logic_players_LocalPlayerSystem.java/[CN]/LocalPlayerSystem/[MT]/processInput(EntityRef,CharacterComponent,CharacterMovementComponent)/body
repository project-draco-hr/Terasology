{
  Vector3f relMove=new Vector3f(relativeMovement);
  relMove.y=0;
  Quat4f viewRot;
switch (characterMovementComponent.mode) {
case WALKING:
    viewRot=new Quat4f(TeraMath.DEG_TO_RAD * characterComponent.yaw,0,0);
  QuaternionUtil.quatRotate(viewRot,relMove,relMove);
break;
case CLIMBING:
break;
default :
viewRot=new Quat4f(TeraMath.DEG_TO_RAD * characterComponent.yaw,TeraMath.DEG_TO_RAD * characterComponent.pitch,0);
QuaternionUtil.quatRotate(viewRot,relMove,relMove);
relMove.y+=relativeMovement.y;
break;
}
entity.send(new CharacterMoveInputEvent(inputSequenceNumber++,lookPitch,lookYaw,relMove,run,jump));
jump=false;
}
