{
  WorldProvider worldProvider=_player.getParent().getWorldProvider();
  RayBlockIntersection.Intersection selectedBlock=_player.getSelectedBlock();
  if (selectedBlock != null) {
    Block centerBlock=BlockManager.getInstance().getBlock(worldProvider.getBlock(_player.getSelectedBlock().getBlockPosition().x,_player.getSelectedBlock().getBlockPosition().y,_player.getSelectedBlock().getBlockPosition().z));
    if (!centerBlock.isAllowBlockAttachment()) {
      return false;
    }
    BlockPosition blockPos=selectedBlock.calcAdjacentBlockPos();
    if (Block.AABBForBlockAt(blockPos.x,blockPos.y,blockPos.z).overlaps(_player.getAABB())) {
      return false;
    }
    worldProvider.setBlock(blockPos.x,blockPos.y,blockPos.z,type,true,true);
    AudioManager.getInstance().playVaryingSound("PlaceBlock",0.6f,0.5f);
    int chunkPosX=MathHelper.calcChunkPosX(blockPos.x);
    int chunkPosZ=MathHelper.calcChunkPosZ(blockPos.z);
    _player.notifyObserversBlockPlaced(worldProvider.getChunkProvider().loadOrCreateChunk(chunkPosX,chunkPosZ),blockPos);
    return true;
  }
  return false;
}
