{
  EntityBuilder builder=entityManager.newBuilder("engine:player");
  builder.getComponent(LocationComponent.class).setWorldPosition(spawnPosition);
  builder.setOwner(controller);
  EntityRef transferSlot=entityManager.create("engine:transferSlot");
  CharacterComponent playerComponent=builder.getComponent(CharacterComponent.class);
  playerComponent.spawnPosition.set(spawnPosition);
  playerComponent.movingItem=transferSlot;
  playerComponent.controller=controller;
  EntityRef chest=blockFactory.newInstance(blockManager.getBlockFamily("core:chest"));
  chest.addComponent(new InventoryComponent(30));
  inventoryManager.giveItem(chest,blockFactory.newInstance(blockManager.getBlockFamily("core:companion"),99));
  inventoryManager.giveItem(chest,blockFactory.newInstance(blockManager.getBlockFamily("core:brick:core:stair"),99));
  inventoryManager.giveItem(chest,blockFactory.newInstance(blockManager.getBlockFamily("core:Tnt"),99));
  inventoryManager.giveItem(chest,blockFactory.newInstance(blockManager.getBlockFamily("core:StoneStair"),99));
  inventoryManager.giveItem(chest,entityManager.create("core:railgunTool"));
  inventoryManager.giveItem(chest,entityManager.create("core:mrbarsack"));
  inventoryManager.giveItem(chest,blockFactory.newInstance(blockManager.getBlockFamily("core:Brick"),99));
  inventoryManager.giveItem(chest,blockFactory.newInstance(blockManager.getBlockFamily("core:Ice"),99));
  inventoryManager.giveItem(chest,blockFactory.newInstance(blockManager.getBlockFamily("core:Plank"),99));
  EntityRef doorItem=entityManager.create("core:door");
  ItemComponent doorItemComp=doorItem.getComponent(ItemComponent.class);
  doorItemComp.stackCount=20;
  doorItem.saveComponent(doorItemComp);
  inventoryManager.giveItem(chest,doorItem);
  EntityRef innerChest=blockFactory.newInstance(blockManager.getBlockFamily("core:Chest"));
  innerChest.addComponent(new InventoryComponent(30));
  inventoryManager.giveItem(innerChest,blockFactory.newInstance(blockManager.getBlockFamily("core:lava"),99));
  inventoryManager.giveItem(innerChest,blockFactory.newInstance(blockManager.getBlockFamily("core:water"),99));
  inventoryManager.giveItem(innerChest,blockFactory.newInstance(blockManager.getBlockFamily("core:Iris"),99));
  inventoryManager.giveItem(innerChest,blockFactory.newInstance(blockManager.getBlockFamily("core:Dandelion"),99));
  inventoryManager.giveItem(innerChest,blockFactory.newInstance(blockManager.getBlockFamily("core:Tulip"),99));
  inventoryManager.giveItem(innerChest,blockFactory.newInstance(blockManager.getBlockFamily("core:YellowFlower"),99));
  inventoryManager.giveItem(chest,innerChest);
  EntityRef player=builder.build();
  inventoryManager.giveItem(player,entityManager.create("core:pickaxe"));
  inventoryManager.giveItem(player,entityManager.create("core:axe"));
  inventoryManager.giveItem(player,blockFactory.newInstance(blockManager.getBlockFamily("core:Torch"),99));
  inventoryManager.giveItem(player,entityManager.create("core:explodeTool"));
  inventoryManager.giveItem(player,entityManager.create("core:railgunTool"));
  inventoryManager.giveItem(player,entityManager.create("core:miniaturizer"));
  inventoryManager.giveItem(player,chest);
  inventoryManager.giveItem(player,blockFactory.newInstance(blockManager.getBlockFamily("core:OakSapling"),10));
  player.send(new SelectedItemChangedEvent(EntityRef.NULL,inventoryManager.getItemInSlot(player,0)));
  return player;
}
