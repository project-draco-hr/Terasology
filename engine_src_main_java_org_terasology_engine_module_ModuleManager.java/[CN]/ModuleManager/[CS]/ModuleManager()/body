{
  metadataReader=new ModuleMetadataReader();
  metadataReader.registerExtension(SERVER_SIDE_ONLY_EXT,Boolean.TYPE);
  Module engineModule;
  try (Reader reader=new InputStreamReader(getClass().getResourceAsStream("/engine-module.txt"))){
    ModuleMetadata metadata=metadataReader.read(reader);
    engineModule=ClasspathModule.create(metadata,getClass(),Module.class);
  }
 catch (  IOException e) {
    throw new RuntimeException("Failed to read engine metadata",e);
  }
catch (  URISyntaxException e) {
    throw new RuntimeException("Failed to convert engine library location to path",e);
  }
  registry=new TableModuleRegistry();
  registry.add(engineModule);
  ModulePathScanner scanner=new ModulePathScanner(new ModuleLoader(metadataReader));
  scanner.getModuleLoader().setModuleInfoPath(TerasologyConstants.MODULE_INFO_FILENAME);
  scanner.scan(registry,PathManager.getInstance().getModulePaths());
  setupSandbox();
  loadEnvironment(Sets.newHashSet(engineModule),true);
}
