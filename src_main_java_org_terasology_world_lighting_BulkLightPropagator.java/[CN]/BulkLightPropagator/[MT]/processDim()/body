{
  int depth=0;
  while (depth < QUEUE_DEPTH) {
    byte oldLuminance=(byte)(15 - depth);
    Set<Vector3i> toProcess=dimQueues[depth];
    dimQueues[depth]=Sets.newLinkedHashSetWithExpectedSize(toProcess.size());
    for (    Vector3i pos : toProcess) {
      purge(pos,oldLuminance);
    }
    if (dimQueues[depth].isEmpty()) {
      depth++;
    }
  }
}
