{
  ModuleManager moduleManager=CoreRegistry.get(ModuleManager.class);
  Module module=moduleManager.getModule(uri.getModuleName());
  if (module == null) {
    throw new UnresolvedWorldGeneratorException("Unknown module '" + uri.getModuleName() + "' for world generator '"+ uri+ "'");
  }
  if (moduleManager.isEnabled(module)) {
    for (    Class<?> generatorClass : module.getReflections().getTypesAnnotatedWith(RegisterWorldGenerator.class)) {
      RegisterWorldGenerator annotation=generatorClass.getAnnotation(RegisterWorldGenerator.class);
      SimpleUri generatorUri=new SimpleUri(module.getModuleInfo().getId(),annotation.id());
      if (generatorUri.equals(uri)) {
        return loadGenerator(generatorClass,generatorUri);
      }
    }
    throw new UnresolvedWorldGeneratorException("Unable to resolve world generator '" + uri + "' - not found");
  }
 else {
    throw new UnresolvedWorldGeneratorException("Cannot load generator '" + uri + "', as the module it resides in is not enabled");
  }
}
