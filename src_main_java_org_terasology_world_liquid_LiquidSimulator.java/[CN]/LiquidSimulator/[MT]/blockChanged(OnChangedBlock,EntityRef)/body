{
  if (!event.getNewType().isLiquid()) {
    LiquidData currentState=world.getLiquid(event.getBlockPosition());
    if (currentState.getDepth() > 0) {
      world.setLiquid(event.getBlockPosition(),new LiquidData(),currentState);
    }
    if (event.getNewType().isPenetrable()) {
      blockQueue.offer(new SimulateBlock(event.getBlockPosition(),world.getTime().getMilliseconds() + PROPAGATION_DELAY));
    }
    for (    Side side : Side.values()) {
      Vector3i adjPos=new Vector3i(event.getBlockPosition());
      adjPos.add(side.getVector3i());
      blockQueue.offer(new SimulateBlock(adjPos,world.getTime().getMilliseconds() + PROPAGATION_DELAY));
    }
  }
 else {
    LiquidData currentState=world.getLiquid(event.getBlockPosition());
    if (currentState.getDepth() == 0) {
      LiquidData newState=new LiquidData((water.equals(event.getNewType())) ? LiquidType.WATER : LiquidType.LAVA,MAX_LIQUID_DEPTH);
      world.setLiquid(event.getBlockPosition(),newState,currentState);
    }
    for (    Side side : Side.values()) {
      Vector3i adjPos=new Vector3i(event.getBlockPosition());
      adjPos.add(side.getVector3i());
      blockQueue.offer(new SimulateBlock(adjPos,world.getTime().getMilliseconds() + PROPAGATION_DELAY));
    }
  }
}
