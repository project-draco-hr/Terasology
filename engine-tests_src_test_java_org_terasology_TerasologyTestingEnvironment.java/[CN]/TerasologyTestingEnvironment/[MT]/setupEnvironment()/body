{
  final JavaArchive homeArchive=ShrinkWrap.create(JavaArchive.class);
  final FileSystem vfs=ShrinkWrapFileSystems.newFileSystem(homeArchive);
  PathManager.getInstance().useOverrideHomePath(vfs.getPath(""));
  if (!setup) {
    setup=true;
    env=new DisplayEnvironment();
    assetManager=CoreRegistry.get(AssetManager.class);
    blockManager=CoreRegistry.get(BlockManager.class);
    config=CoreRegistry.get(Config.class);
    audioManager=CoreRegistry.get(AudioManager.class);
    collisionGroupManager=CoreRegistry.get(CollisionGroupManager.class);
    moduleManager=CoreRegistry.get(ModuleManager.class);
  }
 else {
    CoreRegistry.put(AssetManager.class,assetManager);
    CoreRegistry.put(BlockManager.class,blockManager);
    CoreRegistry.put(Config.class,config);
    CoreRegistry.put(AudioManager.class,audioManager);
    CoreRegistry.put(CollisionGroupManager.class,collisionGroupManager);
    CoreRegistry.put(ModuleManager.class,moduleManager);
  }
  PathManager.getInstance().setCurrentSaveTitle("world1");
}
