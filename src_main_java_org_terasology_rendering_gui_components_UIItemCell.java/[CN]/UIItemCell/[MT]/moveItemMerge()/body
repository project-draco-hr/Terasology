{
  EntityRef item=getFromMovementSlot();
  ItemComponent sourceItem=item.getComponent(ItemComponent.class);
  ItemComponent targetItem=ownerInventory.itemSlots.get(slot).getComponent(ItemComponent.class);
  int spaceLeft=InventorySystem.MAX_STACK - targetItem.stackCount;
  if (spaceLeft < sourceItem.stackCount) {
    targetItem.stackCount=InventorySystem.MAX_STACK;
    sourceItem.stackCount-=spaceLeft;
  }
 else {
    targetItem.stackCount+=sourceItem.stackCount;
    sendToMovementSlot(EntityRef.NULL,(byte)-1);
    setMovementIconVisibility(false);
  }
}
