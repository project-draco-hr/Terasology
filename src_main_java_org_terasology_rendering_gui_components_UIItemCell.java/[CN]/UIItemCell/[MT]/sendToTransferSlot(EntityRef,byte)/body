{
  if (amount == 0) {
    CoreRegistry.get(LocalPlayer.class).getEntity().getComponent(PlayerComponent.class).transferSlot=item;
    if (item.exists()) {
      ownerInventory.itemSlots.set(ownerInventory.itemSlots.indexOf(item),EntityRef.NULL);
    }
  }
 else   if (amount > 0 && amount <= InventorySystem.MAX_STACK) {
    ItemComponent itemComponent=itemEntity.getComponent(ItemComponent.class);
    itemComponent.stackCount-=amount;
    EntityManager entityManager=CoreRegistry.get(EntityManager.class);
    EntityRef moveItem=entityManager.copy(item);
    itemComponent=moveItem.getComponent(ItemComponent.class);
    itemComponent.stackCount=amount;
    itemComponent.container=ownerEntity;
    CoreRegistry.get(LocalPlayer.class).getEntity().getComponent(PlayerComponent.class).transferSlot=moveItem;
  }
  if (getFromTransferSlot().exists()) {
    GUIManager.getInstance().getFocusedWindow().removeDisplayElement(transferIcon);
    GUIManager.getInstance().getFocusedWindow().addDisplayElement(transferIcon,"transferIcon");
    GUIManager.getInstance().getFocusedWindow().removeWindowListener(windowListener);
    GUIManager.getInstance().getFocusedWindow().addWindowListener(windowListener);
    transferIcon.setItemEntity(getFromTransferSlot());
    transferIcon.setVisible(true);
  }
 else {
    GUIManager.getInstance().getFocusedWindow().removeDisplayElement(transferIcon);
    transferIcon.setItemEntity(EntityRef.NULL);
    transferIcon.setVisible(false);
  }
  ownerEntity.saveComponent(ownerInventory);
}
