{
  InventoryComponent ownerInventory=ownerEntity.getComponent(InventoryComponent.class);
  if (amount == -1) {
    CoreRegistry.get(LocalPlayer.class).getEntity().getComponent(PlayerComponent.class).movementSlot=item;
    if (item.exists()) {
      ownerInventory.itemSlots.set(ownerInventory.itemSlots.indexOf(item),EntityRef.NULL);
    }
  }
 else   if (amount > 0 && amount <= InventorySystem.MAX_STACK) {
    ItemComponent itemComponent=itemEntity.getComponent(ItemComponent.class);
    itemComponent.stackCount-=amount;
    EntityManager entityManager=CoreRegistry.get(EntityManager.class);
    EntityRef moveItem=entityManager.copy(item);
    itemComponent=moveItem.getComponent(ItemComponent.class);
    itemComponent.stackCount=amount;
    itemComponent.container=ownerEntity;
    CoreRegistry.get(LocalPlayer.class).getEntity().getComponent(PlayerComponent.class).movementSlot=moveItem;
  }
  ownerEntity.saveComponent(ownerInventory);
}
