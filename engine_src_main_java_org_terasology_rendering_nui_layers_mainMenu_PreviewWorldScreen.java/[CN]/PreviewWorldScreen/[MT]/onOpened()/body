{
  super.onOpened();
  SimpleUri worldGenUri=config.getWorldGeneration().getDefaultGenerator();
  Name moduleName=worldGenUri.getModuleName();
  try {
    DependencyResolver resolver=new DependencyResolver(moduleManager.getRegistry());
    ResolutionResult result=resolver.resolve(moduleName);
    if (result.isSuccess()) {
      subContext=new ContextImpl(context);
      CoreRegistry.setContext(subContext);
      environment=moduleManager.loadEnvironment(result.getModules(),false);
      subContext.put(WorldGeneratorPluginLibrary.class,new TempWorldGeneratorPluginLibrary(environment,subContext));
      EnvironmentSwitchHandler environmentSwitchHandler=context.get(EnvironmentSwitchHandler.class);
      environmentSwitchHandler.handleSwitchToPreviewEnivronment(context,environment);
      genTexture();
      worldGenerator=worldGeneratorManager.createWorldGenerator(worldGenUri,subContext,environment);
      worldGenerator.setWorldSeed(seed.getText());
      previewGen=new FacetLayerPreview(environment,worldGenerator);
      configureProperties();
      triggerUpdate=true;
    }
 else {
      logger.error("Could not resolve modules for: {}",worldGenUri);
    }
  }
 catch (  Exception e) {
    worldGenerator=null;
    logger.error("Unable to load world generator: " + worldGenUri + " for a 2d preview",e);
  }
}
