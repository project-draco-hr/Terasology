{
  for (  EntityRef entity : entityManager.getEntitiesWith(DrowningComponent.class,DrownsComponent.class,LocationComponent.class)) {
    DrowningComponent drowning=entity.getComponent(DrowningComponent.class);
    LocationComponent loc=entity.getComponent(LocationComponent.class);
    DrownsComponent drowns=entity.getComponent(DrownsComponent.class);
    long gameTime=time.getGameTimeInMs();
    if (drowning.isBreathing && gameTime > drowning.endTime) {
      entity.removeComponent(DrowningComponent.class);
    }
 else {
      if (gameTime > drowning.nextDrownDamageTime) {
        EntityRef liquidBlock=blockEntityProvider.getBlockEntityAt(loc.getWorldPosition());
        entity.send(new DoDamageEvent(drowns.drownDamage,EngineDamageTypes.DROWNING.get(),liquidBlock));
        drowning.nextDrownDamageTime=gameTime + drowns.timeBetweenDrownDamage;
        entity.saveComponent(drowning);
      }
    }
  }
}
