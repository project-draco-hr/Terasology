{
  Border3D borderForTreeFacet=region.getBorderForFacet(TreeFacet.class);
  TreeFacet facet=new TreeFacet(region.getRegion(),borderForTreeFacet.extendBy(0,15,10));
  SurfaceHeightFacet surface=region.getRegionFacet(SurfaceHeightFacet.class);
  int minY=facet.getWorldRegion().minY();
  int maxY=facet.getWorldRegion().maxY();
  for (int z=facet.getWorldRegion().minZ(); z <= facet.getWorldRegion().maxZ(); z++) {
    for (int x=facet.getWorldRegion().minX(); x <= facet.getWorldRegion().maxX(); x++) {
      int height=TeraMath.ceilToInt(surface.getWorld(x,z));
      if (height >= minY && height <= maxY) {
        Vector3i pos=new Vector3i(x,height,z);
        if (Predicates.and(filters).apply(pos)) {
          CoreBiome biome=biomeFacet.getWorld(pos.x,pos.z);
          float facetValue=treeSeedNoise.noise(x,z) / 255f;
          for (          TreeGenerator generator : treeGeneratorLookup.row(biome).keySet()) {
            if (treeGeneratorLookup.get(biome,generator) > facetValue) {
              facet.setWorld(x,height,z,generator);
              break;
            }
          }
        }
      }
    }
  }
  return facet;
}
