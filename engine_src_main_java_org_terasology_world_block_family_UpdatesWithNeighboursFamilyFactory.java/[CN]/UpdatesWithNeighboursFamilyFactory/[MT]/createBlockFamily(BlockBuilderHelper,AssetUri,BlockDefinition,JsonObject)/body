{
  TByteObjectMap<BlockDefinition>[] basicBlocks=new TByteObjectMap[7];
  TByteObjectMap<Block> blocksForConnections=new TByteObjectHashMap<>();
  basicBlocks[0]=new TByteObjectHashMap<>();
  putBlockDefinition(basicBlocks[0],blockBuilder,blockDefJson,NO_CONNECTIONS);
  basicBlocks[1]=new TByteObjectHashMap<>();
  putBlockDefinition(basicBlocks[1],blockBuilder,blockDefJson,ONE_CONNECTION);
  basicBlocks[2]=new TByteObjectHashMap<>();
  putBlockDefinition(basicBlocks[2],blockBuilder,blockDefJson,TWO_CONNECTIONS_LINE);
  putBlockDefinition(basicBlocks[2],blockBuilder,blockDefJson,TWO_CONNECTIONS_CORNER);
  basicBlocks[3]=new TByteObjectHashMap<>();
  putBlockDefinition(basicBlocks[3],blockBuilder,blockDefJson,THREE_CONNECTIONS_CORNER);
  putBlockDefinition(basicBlocks[3],blockBuilder,blockDefJson,THREE_CONNECTIONS_T);
  basicBlocks[4]=new TByteObjectHashMap<>();
  putBlockDefinition(basicBlocks[4],blockBuilder,blockDefJson,FOUR_CONNECTIONS_CROSS);
  putBlockDefinition(basicBlocks[4],blockBuilder,blockDefJson,FOUR_CONNECTIONS_SIDE);
  basicBlocks[5]=new TByteObjectHashMap<>();
  putBlockDefinition(basicBlocks[5],blockBuilder,blockDefJson,FIVE_CONNECTIONS);
  basicBlocks[6]=new TByteObjectHashMap<>();
  putBlockDefinition(basicBlocks[6],blockBuilder,blockDefJson,SIX_CONNECTIONS);
  BlockUri blockUri=new BlockUri(blockDefUri.getModuleName(),blockDefUri.getAssetName());
  for (byte connections=0; connections < 64; connections++) {
    if ((connections & connectionSides) == connections) {
      Block block=constructBlockForConnections(connections,blockBuilder,blockDefUri,basicBlocks);
      if (block == null) {
        throw new IllegalStateException("Unable to find correct block definition for connections: " + connections);
      }
      block.setUri(new BlockUri(blockUri,String.valueOf(connections)));
      blocksForConnections.put(connections,block);
    }
  }
  final Block archetypeBlock=blocksForConnections.get(SideBitFlag.getSides(Side.RIGHT,Side.LEFT));
  return new UpdatesWithNeighboursFamily(connectionCondition,blockUri,blockDefinition.categories,archetypeBlock,blocksForConnections,connectionSides);
}
