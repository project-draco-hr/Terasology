{
  if (text.length() < 2) {
    return text;
  }
  int texLen=text.length();
  char[] data=new char[texLen];
  text.getChars(0,texLen,data,0);
  for (int len=2; len <= texLen; len++) {
    if (fm.charsWidth(data,0,len) >= maxTextWidth) {
      return text.substring(0,len - 2) + "..";
    }
  }
  return text;
}
