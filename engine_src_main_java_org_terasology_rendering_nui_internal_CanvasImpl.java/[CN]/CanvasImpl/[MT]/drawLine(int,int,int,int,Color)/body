{
  Rect2i region=Rect2i.createFromMinAndMax(Math.min(startX,endX),Math.min(startY,endY),Math.max(startX,endX),Math.max(startY,endY));
  Rect2i absoluteRegion=relativeToAbsolute(region);
  Rect2i finalRegion=state.cropRegion.intersect(absoluteRegion);
  if (!finalRegion.isEmpty()) {
    int sx=startX >= endX ? finalRegion.minX() : finalRegion.maxX();
    int sy=startY >= endY ? finalRegion.minY() : finalRegion.maxY();
    int ex=startX >= endX ? finalRegion.maxX() : finalRegion.minX();
    int ey=startY >= endY ? finalRegion.maxY() : finalRegion.minY();
    if (state.drawOnTop) {
      drawOnTopOperations.add(new DrawLineOperation(sx,sy,ex,ey,color));
    }
 else {
      renderer.drawLine(sx,sy,ex,ey,color);
    }
  }
}
