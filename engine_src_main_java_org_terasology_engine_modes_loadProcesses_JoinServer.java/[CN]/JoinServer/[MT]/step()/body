{
  if (joinStatus.getStatus() == JoinStatus.Status.COMPLETE) {
    ServerInfoMessage serverInfo=networkSystem.getServer().getInfo();
    gameManifest.setTitle(serverInfo.getGameName());
    for (    WorldInfo worldInfo : serverInfo.getWorldInfoList()) {
      gameManifest.addWorld(worldInfo);
    }
    Map<String,Short> blockMap=Maps.newHashMap();
    for (    Entry<Integer,String> entry : serverInfo.getBlockIds().entrySet()) {
      String name=entry.getValue();
      Short id=Short.valueOf(entry.getKey().shortValue());
      Short oldId=blockMap.put(name,id);
      if (oldId != null && oldId != id) {
        logger.warn("Overwriting ID {} for {} with ID {}",oldId,name,id);
      }
    }
    gameManifest.setRegisteredBlockFamilies(serverInfo.getRegisterBlockFamilyList());
    gameManifest.setBlockIdMap(blockMap);
    gameManifest.setTime(networkSystem.getServer().getInfo().getTime());
    ModuleManager moduleManager=CoreRegistry.get(ModuleManager.class);
    moduleManager.disableAllModules();
    for (    ModuleInfo moduleInfo : networkSystem.getServer().getInfo().getModuleList()) {
      Module module=moduleManager.getModule(moduleInfo.getId(),Version.create(moduleInfo.getVersion()));
      if (module == null) {
        StateMainMenu mainMenu=new StateMainMenu("Missing required module: " + moduleInfo.getId() + ":"+ moduleInfo.getVersion());
        CoreRegistry.get(GameEngine.class).changeState(mainMenu);
        return false;
      }
 else {
        logger.debug("Activating module: {}:{}",moduleInfo.getId(),moduleInfo.getVersion());
        gameManifest.addModule(module.getId(),module.getVersion());
        moduleManager.enableModule(module);
      }
    }
    CoreRegistry.get(Game.class).load(gameManifest);
    ApplyModulesUtil.applyModules();
    return true;
  }
 else   if (joinStatus.getStatus() == JoinStatus.Status.FAILED) {
    StateMainMenu mainMenu=new StateMainMenu("Failed to connect to server: " + joinStatus.getErrorMessage());
    CoreRegistry.get(GameEngine.class).changeState(mainMenu);
  }
  return false;
}
