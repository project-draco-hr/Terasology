{
  if (!isVisible()) {
    return previouslyConsumed;
  }
  boolean cropped=previouslyCropped;
  boolean consumed=previouslyConsumed;
  if (mouseMoveListeners.size() > 0 || mouseButtonListeners.size() > 0 || clickListeners.size() > 0 || doubleClickListeners.size() > 0) {
    if (intersects(new Vector2f(Mouse.getX(),Display.getHeight() - Mouse.getY()))) {
      if (!cropped) {
        if (lastMouseState == EMouseEvents.ENTER && (consumed || cropped)) {
          notifyMouseMoveListeners(EMouseEvents.LEAVE,consumed);
          lastMouseState=EMouseEvents.LEAVE;
        }
        if (button != -1 && state && !mouseIsDown) {
          notifyMouseButtonListeners(button,true,wheelMoved,true,consumed);
          if (!consumed) {
            mouseIsDown=true;
            if (consumeEvents) {
              consumed=true;
            }
          }
        }
 else         if (button != -1 && !state && mouseIsDown) {
          notifyClickListeners(button,consumed);
          notifyMouseButtonListeners(button,false,wheelMoved,true,consumed);
          mouseIsDown=false;
          if ((System.currentTimeMillis() - lastTime) < doubleClickTimeout && lastButton == button) {
            notifyDoubleClickListeners(button);
          }
          lastTime=System.currentTimeMillis();
          lastButton=button;
          if (!consumed && consumeEvents) {
            consumed=true;
          }
        }
        if (lastMouseState == EMouseEvents.LEAVE || lastMouseState == null) {
          notifyMouseMoveListeners(EMouseEvents.ENTER,consumed);
          if (!consumed) {
            lastMouseState=EMouseEvents.ENTER;
            if (consumeEvents) {
              consumed=true;
            }
          }
        }
        if (wheelMoved != 0) {
          notifyMouseButtonListeners(-1,false,wheelMoved,true,consumed);
        }
        notifyMouseMoveListeners(EMouseEvents.HOVER,consumed);
        if (!consumed) {
          lastMouseState=EMouseEvents.ENTER;
          if (consumeEvents) {
            consumed=true;
          }
        }
      }
 else {
        if (lastMouseState == EMouseEvents.ENTER) {
          notifyMouseMoveListeners(EMouseEvents.LEAVE,consumed);
          lastMouseState=EMouseEvents.LEAVE;
        }
      }
    }
 else {
      if (button != -1 && state && !mouseIsDown) {
        notifyMouseButtonListeners(button,true,wheelMoved,false,consumed);
      }
 else       if (button != -1 && !state) {
        notifyMouseButtonListeners(button,false,wheelMoved,false,consumed);
        mouseIsDown=false;
      }
      if (wheelMoved != 0) {
        notifyMouseButtonListeners(-1,false,wheelMoved,false,consumed);
      }
      if (lastMouseState == EMouseEvents.ENTER || lastMouseState == null) {
        notifyMouseMoveListeners(EMouseEvents.LEAVE,consumed);
        lastMouseState=EMouseEvents.LEAVE;
      }
    }
  }
  if (mouseMoveListeners.size() > 0 && button == -1 && wheelMoved == 0) {
    notifyMouseMoveListeners(EMouseEvents.MOVE,consumed);
  }
  return consumed;
}
