{
  Vector3i chunkPos=TeraMath.calcChunkPos(x,y,z);
  ChunkImpl chunk=chunkProvider.getChunk(chunkPos);
  if (chunk != null) {
    chunk.lock();
    try {
      Vector3i blockPos=TeraMath.calcBlockPos(x,y,z);
      LiquidData liquidState=chunk.getLiquid(blockPos);
      if (liquidState.equals(oldState)) {
        chunk.setLiquid(blockPos,newState);
        return true;
      }
    }
  finally {
      chunk.unlock();
    }
  }
  return false;
}
