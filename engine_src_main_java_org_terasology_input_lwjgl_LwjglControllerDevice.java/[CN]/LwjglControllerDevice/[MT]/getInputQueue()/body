{
  Queue<ControllerAction> result=new ArrayDeque<>();
  while (Controllers.next()) {
    int controller=Controllers.getEventSource().getIndex();
    float axisValue=0f;
    Input input;
    ButtonState state=ButtonState.UP;
    if (Controllers.isEventButton()) {
      state=Controllers.getEventButtonState() ? ButtonState.DOWN : ButtonState.UP;
      input=InputType.CONTROLLER_BUTTON.getInput(Controllers.getEventControlIndex());
    }
 else     if (Controllers.isEventXAxis()) {
      axisValue=Controllers.getEventXAxisValue();
      input=InputType.CONTROLLER_AXIS.getInput(ControllerId.X_AXIS);
    }
 else     if (Controllers.isEventYAxis()) {
      axisValue=Controllers.getEventYAxisValue();
      input=InputType.CONTROLLER_AXIS.getInput(ControllerId.Y_AXIS);
    }
 else {
      continue;
    }
    result.add(new ControllerAction(input,controller,state,axisValue));
  }
  return result;
}
