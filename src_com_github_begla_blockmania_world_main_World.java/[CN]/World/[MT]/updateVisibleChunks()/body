{
  _visibleChunks.clear();
  _bulletPhysicsRenderer.resetChunks();
  _visibleTriangles=0;
  for (int i=0; i < _chunksInProximity.size(); i++) {
    Chunk c=_chunksInProximity.get(i);
    if (c.getActiveChunkMesh() != null) {
      if (c.getActiveChunkMesh()._bulletMeshShape != null) {
        Vector3f position=new Vector3f(c.getPosition());
        position.x*=Chunk.getChunkDimensionX();
        position.y*=Chunk.getChunkDimensionY();
        position.z*=Chunk.getChunkDimensionZ();
        _bulletPhysicsRenderer.addStaticChunk(position,_chunksInProximity.get(i).getActiveChunkMesh()._bulletMeshShape);
      }
    }
    if (isChunkVisible(c)) {
      _visibleChunks.add(c);
      if (c.getActiveChunkMesh() != null) {
        _visibleTriangles+=c.getActiveChunkMesh().countTriangles();
      }
      if (c.isDirty() || c.isLightDirty()) {
        if (!_chunkUpdateManager.queueChunkUpdate(c,ChunkUpdateManager.UPDATE_TYPE.DEFAULT))         continue;
      }
      if (Blockmania.getInstance().getTime() - _lastVboUpdate > VBO_UPDATE_GAP) {
        if (c.generateVBOs()) {
          _lastVboUpdate=Blockmania.getInstance().getTime();
        }
        c.update();
      }
      continue;
    }
  }
}
