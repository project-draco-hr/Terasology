{
  clear();
  FileInputStream in=new FileInputStream(file);
  BufferedReader bufferedReader=new BufferedReader(new InputStreamReader(in));
  EntityData.World world=null;
  try {
switch (format) {
case Binary:
      world=EntityData.World.parseFrom(in);
    break;
case Text:
  EntityData.World.Builder builder=EntityData.World.newBuilder();
TextFormat.merge(bufferedReader,builder);
world=builder.build();
break;
case JSON:
throw new IOException("Reading JSON format not supported yet");
}
}
  finally {
try {
in.close();
}
 catch (IOException e) {
logger.log(Level.SEVERE,"Failed to close file",e);
}
}
if (world != null) {
entityPersister.deserializeWorld(world);
}
}
