{
  Terasology.getInstance().getLogger().log(Level.INFO,"Loading shader {0} ({1}, type = {2})",new String[]{title,filename,String.valueOf(type)});
  HashMap<String,Integer> shaders;
  if (type == GL20.GL_FRAGMENT_SHADER) {
    shaders=_fragmentShader;
  }
 else   if (type == GL20.GL_VERTEX_SHADER) {
    shaders=_vertexShader;
  }
 else {
    return 0;
  }
  shaders.put(title,GL20.glCreateShader(type));
  if (shaders.get(title) == 0) {
    return 0;
  }
  String fragCode=_preProcessorPreamble + "\n";
  String line;
  try {
    BufferedReader reader=new BufferedReader(new InputStreamReader(ResourceLoader.getResource("org/terasology/data/shaders/" + filename).openStream()));
    while ((line=reader.readLine()) != null) {
      fragCode+=line + "\n";
    }
  }
 catch (  Exception e) {
    Terasology.getInstance().getLogger().log(Level.SEVERE,"Failed to read shader.");
    return 0;
  }
  GL20.glShaderSource(shaders.get(title),fragCode);
  GL20.glCompileShader(shaders.get(title));
  printLogInfo(shaders.get(title));
  return shaders.get(title);
}
