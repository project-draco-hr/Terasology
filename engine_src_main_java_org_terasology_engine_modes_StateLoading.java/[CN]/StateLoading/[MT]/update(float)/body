{
  long startTime=1000 * Sys.getTime() / Sys.getTimerResolution();
  while (current != null && 1000 * Sys.getTime() / Sys.getTimerResolution() - startTime < 20) {
    if (current.step()) {
      popStep();
    }
  }
  if (current == null) {
    nuiManager.popScreen();
    CoreRegistry.get(GameEngine.class).changeState(new StateIngame());
  }
 else {
    float progressValue=(progress + current.getExpectedCost() * current.getProgress()) / maxProgress;
    loadingScreen.updateStatus(current.getMessage(),progressValue);
    nuiManager.update(delta);
  }
}
