{
  if (entityStoreBuilder == null) {
    throw new IllegalStateException("Entity Store not ready for storing entities");
  }
  for (  EntityRef ownedEntity : helper.listOwnedEntities(entity)) {
    store(ownedEntity);
  }
  if (entity.exists()) {
    entity.send(new OnStoreEvent(this));
    EntityData.Entity entityData=serializer.serialize(entity,true,FieldSerializeCheck.NullCheck.<Component>newInstance());
    entityStoreBuilder.addEntity(entityData);
    entityStoreBuilder.addEntityName(name);
    entityManager.removedForStoring(entity);
  }
}
