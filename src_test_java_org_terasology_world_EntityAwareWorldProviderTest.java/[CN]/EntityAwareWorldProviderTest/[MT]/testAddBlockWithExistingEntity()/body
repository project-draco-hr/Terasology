{
  Prefab prefab=prefabManager.createPrefab(PREFAB_URI);
  prefab.addComponent(new StringComponent());
  Block persistentEntityBlock=new Block();
  persistentEntityBlock.setEntityMode(BlockEntityMode.PERSISTENT);
  persistentEntityBlock.setEntityPrefab(PREFAB_URI);
  blockManager.addBlockFamily(new SymmetricFamily(new BlockUri("unittest:block"),persistentEntityBlock),false);
  EntityRef entity=entityManager.create(prefab);
  StringComponent comp=entity.getComponent(StringComponent.class);
  comp.value="hi";
  entity.saveComponent(comp);
  assertTrue(worldProvider.setBlock(0,0,0,persistentEntityBlock,BlockManager.getAir(),entity));
  List<EntityRef> blockEntities=Lists.newArrayList(entityManager.listEntitiesWith(BlockComponent.class));
  for (  EntityRef entityFound : blockEntities) {
    System.out.println(entityFound.toFullDescription());
  }
  assertEquals(1,blockEntities.size());
  assertEquals(blockEntities.get(0),entity);
  assertNotNull(blockEntities.get(0).getComponent(StringComponent.class));
  assertEquals("hi",blockEntities.get(0).getComponent(StringComponent.class).value);
  assertNotNull(blockEntities.get(0).getComponent(BlockComponent.class));
  assertFalse(blockEntities.get(0).getComponent(BlockComponent.class).temporary);
}
