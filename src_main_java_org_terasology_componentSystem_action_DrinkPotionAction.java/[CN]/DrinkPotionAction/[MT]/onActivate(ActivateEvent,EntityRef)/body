{
  potion=entity.getComponent(PotionComponent.class);
  poisoned=entity.getComponent(PoisonedComponent.class);
  EntityManager entityManager=CoreRegister.get(EntityManager.class);
  HealthComponent health=event.getTarget().getComponent(HealthComponent.class);
  ItemComponent itemComp=entity.getComponent(ItemComponent.class);
  EntityRef item=entityManager.create("core:emptyVial");
switch (potion.type) {
case Red:
    event.getInstigator().send(new BoostHpEvent());
  event.getInstigator().send(new ReceiveItemEvent(item));
if (itemComp != null && !itemComp.container.exists()) {
  item.destroy();
}
break;
case Green:
event.getInstigator().send(new ReceiveItemEvent(item));
if (itemComp != null && !itemComp.container.exists()) {
item.destroy();
}
event.getInstigator().send(new PoisonedEvent());
break;
case Orange:
event.getInstigator().send(new CurePoisonEvent());
event.getInstigator().send(new ReceiveItemEvent(item));
if (itemComp != null && !itemComp.container.exists()) {
item.destroy();
}
break;
case Purple:
event.getInstigator().send(new ReceiveItemEvent(item));
if (itemComp != null && !itemComp.container.exists()) {
item.destroy();
}
event.getInstigator().send(new BoostSpeedEvent());
break;
default :
break;
}
}
