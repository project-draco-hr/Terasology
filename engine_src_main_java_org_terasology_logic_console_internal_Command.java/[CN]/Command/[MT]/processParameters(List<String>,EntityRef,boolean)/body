{
  int senderRelativeIndex=includeSender ? 1 : 0;
  int singleParameterCount=parameters.length + (endsWithVarargs() ? -1 : 0);
  Object[] processedParameters=new Object[parameters.length + senderRelativeIndex];
  if (includeSender) {
    processedParameters[0]=sender;
  }
  for (int i=0; i < singleParameterCount && i < rawParameters.size(); i++) {
    String rawParam=rawParameters.get(i);
    CommandParameter param=parameters[i];
    processedParameters[i + senderRelativeIndex]=param.getValue(rawParam);
  }
  if (endsWithVarargs()) {
    int varargsIndex=parameters.length - 1;
    CommandParameter varargsParameter=parameters[varargsIndex];
    Object varargsResult;
    if (rawParameters.size() <= varargsIndex) {
      varargsResult=null;
    }
 else {
      StringBuilder rawParam=new StringBuilder(rawParameters.get(varargsIndex));
      for (int i=varargsIndex + senderRelativeIndex; i < rawParameters.size(); i++) {
        rawParam.append(ARRAY_DELIMITER_VARARGS).append(rawParameters.get(i));
      }
      varargsResult=varargsParameter.getValue(rawParam.toString());
    }
    processedParameters[varargsIndex + senderRelativeIndex]=varargsResult;
  }
  return processedParameters;
}
