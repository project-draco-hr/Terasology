{
  Block centerBlock=BlockManager.getInstance().getBlock(worldProvider.getBlock(targetBlock.x,targetBlock.y,targetBlock.z));
  if (!centerBlock.isAllowBlockAttachment()) {
    return false;
  }
  Vector3i blockPos=new Vector3i(targetBlock);
  blockPos.add(surfaceDirection.getVector3i());
  Block adjBlock=BlockManager.getInstance().getBlock(worldProvider.getBlock(blockPos.x,blockPos.y,blockPos.z));
  if (adjBlock != null && !adjBlock.isInvisible() && !adjBlock.isSelectionRayThrough()) {
    return false;
  }
  if (!block.isPenetrable()) {
    for (    EntityRef player : entityManager.iteratorEntities(PlayerComponent.class,AABBCollisionComponent.class,LocationComponent.class)) {
      LocationComponent location=player.getComponent(LocationComponent.class);
      AABBCollisionComponent collision=player.getComponent(AABBCollisionComponent.class);
      Vector3f worldPos=location.getWorldPosition();
      for (      AABB blockAABB : block.getColliders(blockPos.x,blockPos.y,blockPos.z)) {
        if (blockAABB.overlaps(new AABB(worldPos,collision.getExtents()))) {
          return false;
        }
      }
    }
  }
  return true;
}
