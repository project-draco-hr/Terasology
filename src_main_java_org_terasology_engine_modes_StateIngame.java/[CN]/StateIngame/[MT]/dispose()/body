{
  boolean saveWorld=CoreRegistry.get(NetworkSystem.class).getMode().isAuthority();
  networkSystem.shutdown();
  eventSystem.process();
  componentSystemManager.shutdown();
  guiManager.closeAllWindows();
  CoreRegistry.get(BulletPhysics.class).dispose();
  StorageManager storageManager=CoreRegistry.get(StorageManager.class);
  if (storageManager != null) {
    try {
      storageManager.flush();
    }
 catch (    IOException e) {
      logger.error("Failed to save game",e);
    }
    storageManager.shutdown();
  }
  entityManager.clear();
  if (worldRenderer != null) {
    worldRenderer.dispose(saveWorld);
    worldRenderer=null;
  }
  CoreRegistry.get(Console.class).dispose();
  CoreRegistry.clear();
  BlockManager.getAir().setEntity(EntityRef.NULL);
}
