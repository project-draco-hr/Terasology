{
  lock();
  try {
    TeraArray packed=blocks.pack();
    if (packed != blocks) {
      System.out.println(String.format("packed chunk (%d, %d, %d), before=%d, after=%d",pos.x,pos.y,pos.z,blocks.estimatedMemoryConsumptionInBytes(),packed.estimatedMemoryConsumptionInBytes()));
      blocks=packed;
    }
  }
  finally {
    unlock();
  }
}
