{
  Preconditions.checkNotNull(message,"The parameter 'message' must not be null");
  if (!message.hasType())   throw new UnsupportedOperationException("Illformed protobuf message. Missing type information.");
  final ChunksProtobuf.Type type=message.getType();
  final Entry entry;
  if (type == ChunksProtobuf.Type.Unknown) {
    if (!message.hasClassName())     throw new UnsupportedOperationException("Illformed protobuf message. Missing class name.");
    entry=get(message.getClassName());
    if (entry == null)     throw new UnsupportedOperationException("Unable to decode protobuf message. No entry found for class name: " + message.getClassName());
  }
 else {
    entry=get(type);
    if (entry == null)     throw new UnsupportedOperationException("Unable to decode protobuf message. No entry found for type: " + type);
  }
  if (!message.hasData())   throw new UnsupportedOperationException("Illformed protobuf message. Missing byte sequence.");
  final ByteString data=message.getData();
  return entry.handler.deserialize(data.asReadOnlyByteBuffer());
}
