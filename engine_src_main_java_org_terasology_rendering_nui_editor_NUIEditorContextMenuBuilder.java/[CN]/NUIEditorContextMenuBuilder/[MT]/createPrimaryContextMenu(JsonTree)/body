{
  ContextMenuBuilder contextMenu=new ContextMenuBuilder();
  ContextMenuLevel primaryLevel=contextMenu.addLevel(true);
  JsonTreeValue.Type type=node.getValue().getType();
  if ((type == JsonTreeValue.Type.ARRAY && !node.getValue().getKey().equals("contents")) || type == JsonTreeValue.Type.OBJECT) {
    ContextMenuLevel addLevel=contextMenu.addLevel(false);
    primaryLevel.addNavigationOption(OPTION_ADD_EXTENDED,addLevel);
    createAddContextMenu(node,addLevel);
  }
  if (type == JsonTreeValue.Type.ARRAY && node.getValue().getKey().equals("contents")) {
    primaryLevel.addOption(OPTION_ADD_WIDGET,externalConsumers.get(OPTION_ADD_WIDGET),node,true);
  }
  primaryLevel.addOption(OPTION_COPY,externalConsumers.get(OPTION_COPY),node,true);
  primaryLevel.addOption(OPTION_PASTE,externalConsumers.get(OPTION_PASTE),node,true);
  if (type != JsonTreeValue.Type.NULL && !(type == JsonTreeValue.Type.OBJECT && !node.isRoot() && node.getParent().getValue().getType() == JsonTreeValue.Type.ARRAY)) {
    primaryLevel.addOption(OPTION_EDIT,externalConsumers.get(OPTION_EDIT),node,true);
  }
  return contextMenu;
}
