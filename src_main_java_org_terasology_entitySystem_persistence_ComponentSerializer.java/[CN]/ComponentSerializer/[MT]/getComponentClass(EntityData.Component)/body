{
  if (componentData.hasTypeIndex()) {
    ComponentMetadata metadata=null;
    if (!componentIdTable.isEmpty()) {
      Class<? extends Component> componentClass=componentIdTable.inverse().get(componentData.getTypeIndex());
      if (componentClass != null) {
        metadata=componentLibrary.getMetadata(componentClass);
      }
    }
    if (metadata == null) {
      logger.warn("Unable to deserialize unknown component with id: {}",componentData.getTypeIndex());
      return null;
    }
    return (Class<? extends Component>)metadata.getType();
  }
 else   if (componentData.hasType()) {
    ComponentMetadata metadata=componentLibrary.getMetadata(componentData.getType());
    if (metadata == null) {
      logger.warn("Unable to deserialize unknown component type: {}",componentData.getType());
      return null;
    }
    return (Class<? extends Component>)metadata.getType();
  }
  logger.warn("Unable to deserialize component, no type provided.");
  return null;
}
