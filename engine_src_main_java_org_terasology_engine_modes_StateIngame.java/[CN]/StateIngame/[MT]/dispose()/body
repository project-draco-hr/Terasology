{
  if (CoreRegistry.get(Config.class).getRendering().isOculusVrSupport() && OculusVrHelper.isNativeLibraryLoaded()) {
    logger.info("Shutting down Oculus SDK...");
    TeraOVR.clear();
  }
  boolean save=networkSystem.getMode().isAuthority();
  if (save) {
    storageManager.waitForCompletionOfPreviousSaveAndStartSaving();
  }
  networkSystem.shutdown();
  eventSystem.process();
  GameThread.processWaitingProcesses();
  nuiManager.clear();
  if (worldRenderer != null) {
    worldRenderer.dispose();
    worldRenderer=null;
  }
  componentSystemManager.shutdown();
  CoreRegistry.get(PhysicsEngine.class).dispose();
  entityManager.clear();
  storageManager.finishSavingAndShutdown();
  ModuleEnvironment environment=CoreRegistry.get(ModuleManager.class).loadEnvironment(Collections.<Module>emptySet(),true);
  CoreRegistry.get(AssetManager.class).setEnvironment(environment);
  CoreRegistry.get(Console.class).dispose();
  CoreRegistry.clear();
  BlockManager.getAir().setEntity(EntityRef.NULL);
  GameThread.clearWaitingProcesses();
  nuiManager.getHUD().clearVisibleBinding();
}
