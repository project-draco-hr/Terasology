{
  CharacterComponent character=localPlayer.getCharacterEntity().getComponent(CharacterComponent.class);
  if (character == null) {
    return;
  }
  CharacterMovementComponent charMoveComp=localPlayer.getCharacterEntity().getComponent(CharacterMovementComponent.class);
  if (charMoveComp == null) {
    return;
  }
  float bobOffset=calcBobbingOffset(charMoveComp.footstepDelta,(float)java.lang.Math.PI / 8f,0.05f);
  float handMovementAnimationOffset=character.handAnimation;
  UIInventoryGrid toolbar=(UIInventoryGrid)CoreRegistry.get(GUIManager.class).getWindowById("hud").getElementById("toolbar");
  int invSlotIndex=character.selectedTool + toolbar.getStartSlot();
  EntityRef heldItem=inventoryManager.getItemInSlot(localPlayer.getCharacterEntity(),invSlotIndex);
  ItemComponent heldItemComp=heldItem.getComponent(ItemComponent.class);
  BlockItemComponent blockItem=heldItem.getComponent(BlockItemComponent.class);
  if (blockItem != null && blockItem.blockFamily != null) {
    renderBlock(blockItem.blockFamily,bobOffset,handMovementAnimationOffset);
  }
 else   if (heldItemComp != null && heldItemComp.renderWithIcon) {
    renderIcon(heldItemComp.icon,bobOffset,handMovementAnimationOffset);
  }
 else {
    renderHand(bobOffset,handMovementAnimationOffset);
  }
}
