{
  int processed=0;
  PerformanceMonitor.startActivity("BlockChangedEventQueue");
  BlockChangedEvent event=eventQueue.poll();
  while (event != null) {
    getOrCreateEntityAt(event.getBlockPosition()).send(event);
    if (processed++ >= 4) {
      break;
    }
    event=eventQueue.poll();
  }
  PerformanceMonitor.endActivity();
  PerformanceMonitor.startActivity("Temp Blocks Cleanup");
  for (  EntityRef entity : tempBlocks) {
    BlockComponent blockComp=entity.getComponent(BlockComponent.class);
    if (blockComp == null || !blockComp.temporary) {
      if (blockComp != null && !entity.hasComponent(NetworkComponent.class)) {
        entity.addComponent(new NetworkComponent());
      }
      continue;
    }
    HealthComponent healthComp=entity.getComponent(HealthComponent.class);
    if (healthComp == null || healthComp.currentHealth == healthComp.maxHealth) {
      entity.destroy();
    }
 else     if (networkSystem.getMode().isAuthority() && !entity.hasComponent(NetworkComponent.class)) {
      entity.addComponent(new NetworkComponent());
    }
  }
  tempBlocks.clear();
  PerformanceMonitor.endActivity();
}
