{
  if (index < 0) {
    index=0;
  }
 else   if (index > text.getText().length()) {
    index=text.getText().length();
  }
  if (index != cursorPosition) {
    Vector2f newPos=toDisplayPosition(index);
    newPos.y-=cursorSize.y;
    cursor.setPosition(newPos);
    if (isMultiLine()) {
      if ((cursor.getSize().y + cursor.getPosition().y - getScrollPosition()) > (getSize().y)) {
        float additionalSpacing=getPadding().z + 5f;
        scrollTo(cursor.getPosition().y * 2 + cursor.getSize().y - getSize().y + additionalSpacing);
      }
 else       if (cursor.getPosition().y - getScrollPosition() < 0) {
        float additionalSpacing=getPadding().x + 5f;
        scrollTo(cursor.getPosition().y - additionalSpacing);
      }
    }
 else {
      if ((cursor.getPosition().x + text.getPosition().x + getPadding().y) > (getSize().x)) {
        text.setPosition(new Vector2f(-(cursor.getPosition().x - getSize().x + getPadding().y + getPadding().w),0f));
      }
 else       if ((cursor.getPosition().x + text.getPosition().x) < 0) {
        text.setPosition(new Vector2f(-cursor.getPosition().x,0f));
      }
    }
    cursorPosition=index;
    notifySelectionListeners();
  }
}
