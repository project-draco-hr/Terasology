{
  LocalPlayer player=CoreRegistry.get(LocalPlayer.class);
  for (int i=_blocks.size() - 1; i >= 0; i--) {
    BlockRigidBody b=_blocks.get(i);
    if (b._temporary)     continue;
    if (b.distanceToPlayer() < 8.0f && !b._picked) {
      b._picked=true;
    }
    if (b._picked && b.distanceToPlayer() < 32.0f) {
      if (b.distanceToPlayer() > 1.0) {
        Transform t=new Transform();
        b.getMotionState().getWorldTransform(t);
        Matrix4f tMatrix=new Matrix4f();
        t.getMatrix(tMatrix);
        Vector3f blockPlayer=new Vector3f();
        tMatrix.get(blockPlayer);
        blockPlayer.sub(new Vector3f(player.getPosition()));
        blockPlayer.normalize();
        blockPlayer.scale(-16000f);
        b.applyCentralImpulse(blockPlayer);
      }
 else {
        Block block=BlockManager.getInstance().getBlock(b.getType());
        EntityRef blockItem=_blockItemFactory.newInstance(block.getBlockFamily());
        if (!CoreRegistry.get(ComponentSystemManager.class).get(InventorySystem.class).addItem(player.getEntity(),blockItem)) {
          blockItem.destroy();
        }
        AudioManager.play("Loot");
        _blocks.remove(i);
        _discreteDynamicsWorld.removeRigidBody(b);
      }
    }
  }
}
