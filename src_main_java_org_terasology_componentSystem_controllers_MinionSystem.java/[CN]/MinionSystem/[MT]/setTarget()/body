{
  LocalPlayer localPlayer=CoreRegistry.get(LocalPlayer.class);
  if (localPlayer == null)   return;
  GroovyHelpManager helpMan=new GroovyHelpManager();
  LocalPlayerComponent localPlayerComponent=localPlayer.getEntity().getComponent(LocalPlayerComponent.class);
  if (!isMinionSelected()) {
    helpMan.spawnCube(localPlayerComponent.selectedMinion);
  }
 else {
    SimpleMinionAIComponent minionai=getSelectedMinion().getComponent(SimpleMinionAIComponent.class);
    if (minionai != null) {
      if (helpMan.calcSelectedBlock() != null) {
        Vector3i centerPos=helpMan.calcSelectedBlock().getBlockPosition();
        minionai.followingPlayer=false;
switch (getSelectedBehaviour()) {
case Follow:
{
            minionai.movementTarget=new Vector3f(centerPos.x,centerPos.y,centerPos.z);
            break;
          }
case Move:
{
          minionai.movementTargets.add(new Vector3f(centerPos.x,centerPos.y,centerPos.z));
          break;
        }
case Gather:
{
        minionai.gatherTargets.add(new Vector3f(centerPos.x,centerPos.y,centerPos.z));
        break;
      }
case Patrol:
{
      minionai.patrolTargets.add(new Vector3f(centerPos.x,centerPos.y,centerPos.z));
      break;
    }
}
}
getSelectedMinion().saveComponent(minionai);
}
}
}
