{
  if (exp <= 0) {
    if (exp == 0) {
      if (base == 0.0) {
        return Double.NaN;
      }
      return 1.0;
    }
    base=1.0 / base;
    exp=-exp;
  }
  double temp=base;
  exp--;
  while (true) {
    if ((exp & 1) != 0) {
      base*=temp;
    }
    exp>>=1;
    if (exp == 0) {
      break;
    }
    temp*=temp;
  }
  return base;
}
