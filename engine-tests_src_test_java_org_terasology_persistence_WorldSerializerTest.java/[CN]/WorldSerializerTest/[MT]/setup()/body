{
  AssetManager assetManager=CoreRegistry.put(AssetManager.class,mock(AssetManager.class));
  when(assetManager.listLoadedAssets(AssetType.PREFAB,Prefab.class)).thenReturn(Collections.<Prefab>emptyList());
  EntitySystemBuilder builder=new EntitySystemBuilder();
  entityManager=builder.build(moduleManager.getEnvironment(),mock(NetworkSystem.class),new ReflectionReflectFactory());
  entityManager.getComponentLibrary().register(new SimpleUri("test","gettersetter"),GetterSetterComponent.class);
  entityManager.getComponentLibrary().register(new SimpleUri("test","string"),StringComponent.class);
  entityManager.getComponentLibrary().register(new SimpleUri("test","integer"),IntegerComponent.class);
  worldSerializer=new WorldSerializerImpl(entityManager,new PrefabSerializer(entityManager.getComponentLibrary(),entityManager.getTypeSerializerLibrary()));
}
