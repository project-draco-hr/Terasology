{
  List<NetData.NetMessage> messages=Lists.newArrayListWithExpectedSize(queuedMessages.size());
  queuedMessages.drainTo(messages);
  for (  NetData.NetMessage message : messages) {
    if (message.hasTime()) {
      timer.updateServerTime(message.getTime(),false);
    }
    for (    NetData.RemoveEntityMessage removeEntity : message.getRemoveEntityList()) {
      int netId=removeEntity.getNetId();
      EntityRef entity=networkSystem.getEntity(netId);
      networkSystem.unregisterNetworkEntity(entity);
      entity.destroy();
    }
    for (    NetData.CreateEntityMessage createEntity : message.getCreateEntityList()) {
      createEntityMessage(createEntity);
    }
    for (    NetData.UpdateEntityMessage updateEntity : message.getUpdateEntityList()) {
      EntityRef currentEntity=networkSystem.getEntity(updateEntity.getNetId());
      if (currentEntity.exists()) {
        logger.info("Updating entity: {}",currentEntity);
        entitySerializer.deserializeOnto(currentEntity,updateEntity.getEntity());
      }
    }
  }
}
