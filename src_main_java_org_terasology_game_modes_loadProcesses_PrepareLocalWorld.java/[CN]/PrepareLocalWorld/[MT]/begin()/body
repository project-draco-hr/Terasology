{
  entityManager=CoreRegistry.get(EntityManager.class);
  worldRenderer=CoreRegistry.get(WorldRenderer.class);
  chunkProvider=worldRenderer.getChunkProvider();
  Iterator<EntityRef> iterator=entityManager.iteratorEntities(LocalPlayerComponent.class).iterator();
  spawningPlayer=!iterator.hasNext();
  if (spawningPlayer) {
    spawnZoneEntity=entityManager.create();
    spawnZoneEntity.addComponent(new LocationComponent(new Vector3f(Chunk.SIZE_X / 2,Chunk.SIZE_Y / 2,Chunk.SIZE_Z / 2)));
    worldRenderer.getChunkProvider().addRegionEntity(spawnZoneEntity,4);
    targetPos=Vector3i.zero();
  }
 else {
    CoreRegistry.get(LocalPlayer.class).setEntity(iterator.next());
    worldRenderer.setPlayer(CoreRegistry.get(LocalPlayer.class));
    targetPos=TeraMath.calcChunkPos(new Vector3i(worldRenderer.getPlayer().getPosition(),0.5f));
  }
  return UNKNOWN_STEPS;
}
