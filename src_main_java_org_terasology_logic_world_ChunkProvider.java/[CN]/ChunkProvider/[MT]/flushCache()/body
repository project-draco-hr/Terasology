{
  if (_running || _nearChunkCache.size() <= CACHE_SIZE)   return;
  _running=true;
  Runnable r=new Runnable(){
    public void run(){
      ArrayList<Chunk> cachedChunks=new ArrayList<Chunk>(_nearChunkCache.values());
      Collections.sort(cachedChunks);
      if (cachedChunks.size() > CACHE_SIZE) {
        Chunk chunkToDelete=cachedChunks.remove(cachedChunks.size() - 1);
        _farChunkCache.put(chunkToDelete);
        _lockChunkCreation.lock();
        try {
          Vector3i pos=chunkToDelete.getPos();
          int id=getNearCacheChunkId(pos.x,pos.y,pos.z);
          _nearChunkCache.remove(id);
        }
  finally {
          _lockChunkCreation.unlock();
        }
        chunkToDelete.dispose();
      }
      _running=false;
    }
  }
;
  CoreRegistry.get(GameEngine.class).submitTask("Flush Chunk Cache",r);
}
