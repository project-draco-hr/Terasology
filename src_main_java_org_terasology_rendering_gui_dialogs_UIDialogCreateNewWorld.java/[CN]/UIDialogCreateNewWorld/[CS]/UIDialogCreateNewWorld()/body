{
  super("Create new world",new Vector2f(512f,320f));
  setModal(true);
  _inputSeed=new UIText(new Vector2f(256f,30f));
  _inputSeed.setBackgroundColor(0xFF,0xFF,0xFF,1.0f);
  _inputSeed.setBorderSolid(1,0x00,0x00,0x00,1.0f);
  _inputSeed.setVisible(true);
  _inputWorldTitle=new UIText(new Vector2f(256f,30f));
  _inputWorldTitle.setBackgroundColor(0xFF,0xFF,0xFF,1.0f);
  _inputWorldTitle.setBorderSolid(1,0x00,0x00,0x00,1.0f);
  _inputWorldTitle.setText(getWorldName());
  _inputWorldTitle.setVisible(true);
  _inputSeedLabel=new UILabel("Enter a seed (optional):");
  _inputSeedLabel.setColor(Color.darkGray);
  _inputSeedLabel.setSize(new Vector2f(0f,16f));
  _inputSeedLabel.setVisible(true);
  _inputWorldTitleLabel=new UILabel("Enter a world name:");
  _inputWorldTitleLabel.setColor(Color.darkGray);
  _inputWorldTitleLabel.setSize(new Vector2f(0f,16f));
  _inputWorldTitleLabel.setVisible(true);
  _chunkGeneratorLabel=new UILabel("Choose Chunk Generator:");
  _chunkGeneratorLabel.setColor(Color.darkGray);
  _chunkGeneratorLabel.setSize(new Vector2f(0f,16f));
  _chunkGeneratorLabel.setVisible(true);
  _chunkGenerator=new UIComboBox(new Vector2f(176f,22f),new Vector2f(176f,64f));
  _chunkGenerator.addItem("Normal",new Integer(0));
  _chunkGenerator.addItem("Flat",new Integer(1));
  _chunkGenerator.setSelectedItemIndex(0);
  _chunkGenerator.setVisible(true);
  _inputWorldTitleLabel.setPosition(new Vector2f(15f,32f));
  _inputWorldTitle.setPosition(new Vector2f(_inputWorldTitleLabel.getPosition().x,_inputWorldTitleLabel.getPosition().y + _inputWorldTitleLabel.getSize().y + 8f));
  _inputSeedLabel.setPosition(new Vector2f(_inputWorldTitle.getPosition().x,_inputWorldTitle.getPosition().y + _inputWorldTitle.getSize().y + 16f));
  _inputSeed.setPosition(new Vector2f(_inputSeedLabel.getPosition().x,_inputSeedLabel.getPosition().y + _inputSeedLabel.getSize().y + 8f));
  _chunkGeneratorLabel.setPosition(new Vector2f(_inputSeed.getPosition().x,_inputSeed.getPosition().y + _inputSeed.getSize().y + 16f));
  _chunkGenerator.setPosition(new Vector2f(_chunkGeneratorLabel.getPosition().x,_chunkGeneratorLabel.getPosition().y + _chunkGeneratorLabel.getSize().y + 8f));
  _okButton=new UIButton(new Vector2f(128f,32f),UIButton.eButtonType.NORMAL);
  _okButton.getLabel().setText("Play");
  _okButton.setPosition(new Vector2f(getSize().x / 2 - _okButton.getSize().x - 16f,getSize().y - _okButton.getSize().y - 10));
  _okButton.setVisible(true);
  _okButton.addClickListener(new ClickListener(){
    @Override public void click(    UIDisplayElement element,    int button){
      if (_inputWorldTitle.getText().isEmpty()) {
        GUIManager.getInstance().showMessage("Error","Please enter a world name");
        return;
      }
 else       if ((new File(PathManager.getInstance().getWorldSavePath(_inputWorldTitle.getText()),WorldInfo.DEFAULT_FILE_NAME)).exists()) {
        GUIManager.getInstance().showMessage("Error","A World with this name already exists");
        return;
      }
      if (_inputSeed.getText().length() > 0) {
        Config.getInstance().setDefaultSeed(_inputSeed.getText());
      }
 else {
        FastRandom random=new FastRandom();
        Config.getInstance().setDefaultSeed(random.randomCharacterString(32));
      }
      if (_inputWorldTitle.getText().length() > 0) {
        Config.getInstance().setWorldTitle(_inputWorldTitle.getText());
      }
 else {
        Config.getInstance().setWorldTitle(getWorldName());
      }
      List<String> chunkList=new ArrayList<String>();
switch (_chunkGenerator.getSelectedItemIndex()) {
case 1:
        chunkList.add(FlatTerrainGenerator.class.getName());
      chunkList.add(FloraGenerator.class.getName());
    chunkList.add(LiquidsGenerator.class.getName());
  chunkList.add(ForestGenerator.class.getName());
break;
default :
chunkList.add(PerlinTerrainGenerator.class.getName());
chunkList.add(FloraGenerator.class.getName());
chunkList.add(LiquidsGenerator.class.getName());
chunkList.add(ForestGenerator.class.getName());
break;
}
String[] chunksListArr=chunkList.toArray(new String[chunkList.size()]);
Config.getInstance().setChunkGenerator(chunksListArr);
CoreRegistry.get(GameEngine.class).changeState(new StateSinglePlayer(new WorldInfo(Config.getInstance().getWorldTitle(),Config.getInstance().getDefaultSeed(),Config.getInstance().getDayNightLengthInMs() / 4,chunksListArr)));
}
}
);
_cancelButton=new UIButton(new Vector2f(128f,32f),UIButton.eButtonType.NORMAL);
_cancelButton.setPosition(new Vector2f(_okButton.getPosition().x + _okButton.getSize().x + 16f,_okButton.getPosition().y));
_cancelButton.getLabel().setText("Cancel");
_cancelButton.setVisible(true);
_cancelButton.addClickListener(new ClickListener(){
@Override public void click(UIDisplayElement element,int button){
close();
}
}
);
addDisplayElement(_inputWorldTitleLabel);
addDisplayElement(_inputWorldTitle);
addDisplayElement(_inputSeedLabel);
addDisplayElement(_inputSeed);
addDisplayElement(_chunkGeneratorLabel);
addDisplayElement(_okButton);
addDisplayElement(_cancelButton);
addDisplayElement(_chunkGenerator);
}
