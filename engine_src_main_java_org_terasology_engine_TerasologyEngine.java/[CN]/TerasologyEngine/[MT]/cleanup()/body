{
  logger.info("Shutting down Terasology...");
  try {
    Iterator<EngineSubsystem> iter=subsystems.descendingIterator();
    while (iter.hasNext()) {
      EngineSubsystem subsystem=iter.next();
      subsystem.shutdown(config);
    }
    config.save();
    if (currentState != null) {
      currentState.dispose();
      currentState=null;
    }
  }
  finally {
    stopThreads();
  }
}
