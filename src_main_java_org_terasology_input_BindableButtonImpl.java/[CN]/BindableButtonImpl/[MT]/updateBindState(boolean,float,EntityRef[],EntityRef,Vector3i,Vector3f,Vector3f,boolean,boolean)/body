{
  if (pressed) {
    activeInputs++;
    if (activeInputs == 1 && mode.isActivatedOnPress()) {
      lastActivateTime=time.getGameTimeInMs();
      if (!keyConsumed) {
        keyConsumed=triggerOnPress(delta,target);
      }
      if (!keyConsumed) {
        buttonEvent.prepare(id,ButtonState.DOWN,delta);
        buttonEvent.setTarget(target,targetBlockPos,hitPosition,hitNormal);
        for (        EntityRef entity : inputEntities) {
          entity.send(buttonEvent);
          if (buttonEvent.isConsumed()) {
            break;
          }
        }
        keyConsumed=buttonEvent.isConsumed();
      }
    }
  }
 else   if (activeInputs != 0) {
    activeInputs--;
    if (activeInputs == 0 && mode.isActivatedOnRelease()) {
      if (!keyConsumed) {
        keyConsumed=triggerOnRelease(delta,target);
      }
      if (!keyConsumed) {
        buttonEvent.prepare(id,ButtonState.UP,delta);
        buttonEvent.setTarget(target,targetBlockPos,hitPosition,hitNormal);
        for (        EntityRef entity : inputEntities) {
          entity.send(buttonEvent);
          if (buttonEvent.isConsumed()) {
            break;
          }
        }
        keyConsumed=buttonEvent.isConsumed();
      }
    }
  }
  return keyConsumed;
}
