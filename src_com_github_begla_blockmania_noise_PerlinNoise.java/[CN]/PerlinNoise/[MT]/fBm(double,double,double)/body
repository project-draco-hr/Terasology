{
  double result=0.0;
  if (_recomputeSpectralWeights) {
    _spectralWeights=new double[_octaves];
    for (int i=0; i < _octaves; i++)     _spectralWeights[i]=Math.pow(LACUNARITY,-H * i);
    _recomputeSpectralWeights=false;
  }
  for (int i=0; i < _octaves; i++) {
    result+=noise(x,y,z) * _spectralWeights[i];
    x*=LACUNARITY;
    y*=LACUNARITY;
    z*=LACUNARITY;
  }
  return result;
}
