{
  double result=0.0;
  if (_spectralWeights == null) {
    _spectralWeights=new double[OCTAVES];
    for (int i=0; i < OCTAVES; i++)     _spectralWeights[i]=Math.pow(LACUNARITY,-H * i);
  }
  for (int i=0; i < OCTAVES; i++) {
    result+=noise(x,y,z) * _spectralWeights[i];
    x*=LACUNARITY;
    y*=LACUNARITY;
    z*=LACUNARITY;
  }
  return result;
}
