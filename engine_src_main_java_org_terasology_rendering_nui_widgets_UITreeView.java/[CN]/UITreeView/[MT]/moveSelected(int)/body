{
  if (state.getSelectedIndex() != null) {
    Tree<T> selectedItem=model.get().getItem(state.getSelectedIndex());
    Tree<T> parent=selectedItem.getParent();
    if (!selectedItem.isRoot()) {
      int itemIndex=parent.getIndex(selectedItem);
      if (keyId == Keyboard.KeyId.UP && itemIndex > 0) {
        parent.removeChild(selectedItem);
        parent.addChild(itemIndex - 1,selectedItem);
        model.get().resetItems();
        state.setSelectedIndex(model.get().indexOf(selectedItem));
        fireUpdateListeners();
      }
 else       if (keyId == Keyboard.KeyId.DOWN && itemIndex < parent.getChildren().size() - 1) {
        parent.removeChild(selectedItem);
        parent.addChild(itemIndex + 1,selectedItem);
        model.get().resetItems();
        state.setSelectedIndex(model.get().indexOf(selectedItem));
        fireUpdateListeners();
      }
    }
  }
}
