{
  this.output=out;
  this.typeMap=typeMap;
  listInfo=typeMap.get(List.class);
  if (listInfo == null)   throw new IOException("Required type for List is missing");
  short id=1;
  for (  Class<? extends Persistable> clazz : persistableClasses.values()) {
    persistableIdMap.put(clazz,id++);
  }
  writeHeader();
}
