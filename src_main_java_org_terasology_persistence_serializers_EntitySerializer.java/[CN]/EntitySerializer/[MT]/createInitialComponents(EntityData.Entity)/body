{
  Map<Class<? extends Component>,Component> componentMap=Maps.newHashMap();
  if (entityData.hasParentPrefab() && !entityData.getParentPrefab().isEmpty() && prefabManager.exists(entityData.getParentPrefab())) {
    Prefab prefab=prefabManager.getPrefab(entityData.getParentPrefab());
    for (    Component component : prefab.iterateComponents()) {
      String componentName=MetadataUtil.getComponentClassName(component.getClass());
      if (!containsIgnoreCase(componentName,entityData.getRemovedComponentList())) {
        componentMap.put(component.getClass(),componentLibrary.copy(component));
      }
    }
    componentMap.put(EntityInfoComponent.class,new EntityInfoComponent(entityData.getParentPrefab(),true,prefab.isAlwaysRelevant()));
  }
  return componentMap;
}
