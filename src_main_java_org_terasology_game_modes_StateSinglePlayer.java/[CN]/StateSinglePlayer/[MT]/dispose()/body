{
  eventSystem.process();
  for (  ComponentSystem system : componentSystemManager.iterateAll()) {
    system.shutdown();
  }
  componentSystemManager.clear();
  guiManager.closeAllWindows();
  try {
    CoreRegistry.get(WorldPersister.class).save(new File(PathManager.getInstance().getWorldSavePath(CoreRegistry.get(WorldProvider.class).getTitle()),TerasologyConstants.ENTITY_DATA_FILE),WorldPersister.SaveFormat.Binary);
  }
 catch (  IOException e) {
    logger.error("Failed to save entities",e);
  }
  entityManager.clear();
  if (worldRenderer != null) {
    worldRenderer.dispose();
    worldRenderer=null;
  }
  CoreRegistry.get(NetworkSystem.class).shutdown();
}
