{
  ModManager modManager=new ModManager();
  for (  Mod mod : modManager.getMods()) {
    mod.setEnabled(true);
  }
  modManager.saveModSelectionToConfig();
  cacheTextures();
  entityManager=new EntitySystemBuilder().build();
  componentSystemManager=new ComponentSystemManager();
  CoreRegistry.put(ComponentSystemManager.class,componentSystemManager);
  localPlayerSys=new LocalPlayerSystem();
  componentSystemManager.register(localPlayerSys,"engine:LocalPlayerSystem");
  cameraTargetSystem=new CameraTargetSystem();
  CoreRegistry.put(CameraTargetSystem.class,cameraTargetSystem);
  componentSystemManager.register(cameraTargetSystem,"engine:CameraTargetSystem");
  inputSystem=new InputSystem();
  CoreRegistry.put(InputSystem.class,inputSystem);
  componentSystemManager.register(inputSystem,"engine:InputSystem");
  componentSystemManager.loadEngineSystems();
  componentSystemManager.loadSystems("miniions","org.terasology.mods.miniions");
  CoreRegistry.put(WorldPersister.class,new WorldPersister(entityManager));
  EventSystem eventSystem=entityManager.getEventSystem();
  eventSystem.registerEvent("engine:inputEvent",InputEvent.class);
  eventSystem.registerEvent("engine:keyDownEvent",KeyDownEvent.class);
  eventSystem.registerEvent("engine:keyEvent",KeyEvent.class);
  eventSystem.registerEvent("engine:keyUpEvent",KeyUpEvent.class);
  eventSystem.registerEvent("engine:keyRepeatEvent",KeyRepeatEvent.class);
  eventSystem.registerEvent("engine:leftMouseDownButtonEvent",LeftMouseDownButtonEvent.class);
  eventSystem.registerEvent("engine:leftMouseUpButtonEvent",LeftMouseUpButtonEvent.class);
  eventSystem.registerEvent("engine:mouseDownButtonEvent",MouseDownButtonEvent.class);
  eventSystem.registerEvent("engine:mouseUpButtonEvent",MouseUpButtonEvent.class);
  eventSystem.registerEvent("engine:mouseButtonEvent",MouseButtonEvent.class);
  eventSystem.registerEvent("engine:mouseWheelEvent",MouseWheelEvent.class);
  eventSystem.registerEvent("engine:rightMouseDownButtonEvent",RightMouseDownButtonEvent.class);
  eventSystem.registerEvent("engine:rightMouseUpButtonEvent",RightMouseUpButtonEvent.class);
  eventSystem.registerEvent("engine:bindButtonEvent",BindButtonEvent.class);
  eventSystem.registerEvent("engine:inventoryButtonEvent",InventoryButton.class);
  loadPrefabs();
}
