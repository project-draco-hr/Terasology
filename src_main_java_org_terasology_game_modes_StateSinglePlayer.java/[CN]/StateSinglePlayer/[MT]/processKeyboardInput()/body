{
  boolean debugEnabled=Config.getInstance().isDebug();
  boolean screenHasFocus=screenHasFocus();
  while (Keyboard.next()) {
    int key=Keyboard.getEventKey();
    if (Keyboard.getEventKeyState()) {
      if (!Keyboard.isRepeatEvent()) {
        if (key == Keyboard.KEY_ESCAPE) {
          if (GUIManager.getInstance().getFocusedWindow() != null) {
            GUIManager.getInstance().removeWindow(GUIManager.getInstance().getFocusedWindow());
          }
 else {
            togglePauseMenu();
          }
        }
        if (key == Keyboard.KEY_I) {
          toggleInventory();
        }
        if (key == Keyboard.KEY_F3) {
          Config.getInstance().setDebug(!Config.getInstance().isDebug());
        }
        if (key == Keyboard.KEY_F && !screenHasFocus) {
          toggleViewingDistance();
        }
        if (key == Keyboard.KEY_F12) {
          _worldRenderer.printScreen();
        }
      }
      if (GUIManager.getInstance().getFocusedWindow() != null) {
        GUIManager.getInstance().processKeyboardInput(key);
      }
 else {
        for (        UIDisplayElement screen : _guiScreens) {
          if (screenCanFocus(screen)) {
            screen.processKeyboardInput(key);
          }
        }
      }
    }
    if (debugEnabled && !screenHasFocus && Keyboard.getEventKeyState()) {
      WorldProvider worldProvider=CoreRegistry.get(WorldProvider.class);
      if (key == Keyboard.KEY_UP) {
        worldProvider.setTimeInDays(worldProvider.getTimeInDays() + 0.005f);
      }
      if (key == Keyboard.KEY_DOWN) {
        worldProvider.setTimeInDays(worldProvider.getTimeInDays() - 0.005f);
      }
      if (key == Keyboard.KEY_RIGHT) {
        worldProvider.setTimeInDays(worldProvider.getTimeInDays() + 0.02f);
      }
      if (key == Keyboard.KEY_LEFT) {
        worldProvider.setTimeInDays(worldProvider.getTimeInDays() - 0.02f);
      }
      if (key == Keyboard.KEY_R && !Keyboard.isRepeatEvent()) {
        getWorldRenderer().setWireframe(!getWorldRenderer().isWireframe());
      }
      if (key == Keyboard.KEY_P && !Keyboard.isRepeatEvent()) {
        getWorldRenderer().setCameraMode(WorldRenderer.CAMERA_MODE.PLAYER);
      }
      if (key == Keyboard.KEY_O && !Keyboard.isRepeatEvent()) {
        getWorldRenderer().setCameraMode(WorldRenderer.CAMERA_MODE.SPAWN);
      }
    }
    if (!screenHasFocus)     localPlayerSys.processKeyboardInput(key,Keyboard.getEventKeyState(),Keyboard.isRepeatEvent());
  }
}
