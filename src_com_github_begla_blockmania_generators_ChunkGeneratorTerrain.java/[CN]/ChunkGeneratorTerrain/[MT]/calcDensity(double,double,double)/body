{
  double height=calcBaseTerrain(x,z);
  double temp=calcTemperatureAtGlobalPosition(x,y);
  double hum=calcHumidityAtGlobalPosition(x,y);
  double dT=Math.abs(temp - 0.5);
  double dH=Math.abs(hum - 0.4);
  double mIntens=MathHelper.clamp(1.0 - (dT + dH) * 5.0) + 0.3;
  double densityMountains=calcMountainDensity(x,y,z) * mIntens * height;
  double densityHills=(calcHillDensity(x,y,z) * height);
  return -y + (((height * 80.0) + 16.0) + densityMountains * 1024.0 + densityHills * 256);
}
