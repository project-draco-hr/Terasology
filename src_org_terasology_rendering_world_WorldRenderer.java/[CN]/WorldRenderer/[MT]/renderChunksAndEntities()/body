{
  ShaderManager.getInstance().enableShader("chunk");
  GL13.glActiveTexture(GL13.GL_TEXTURE1);
  TextureManager.getInstance().bindTexture("custom_lava_still");
  GL13.glActiveTexture(GL13.GL_TEXTURE2);
  TextureManager.getInstance().bindTexture("water_normal");
  GL13.glActiveTexture(GL13.GL_TEXTURE3);
  TextureManager.getInstance().bindTexture("effects");
  GL13.glActiveTexture(GL13.GL_TEXTURE0);
  TextureManager.getInstance().bindTexture("terrain");
  int lavaTexture=GL20.glGetUniformLocation(ShaderManager.getInstance().getShader("chunk"),"textureLava");
  int textureWaterNormal=GL20.glGetUniformLocation(ShaderManager.getInstance().getShader("chunk"),"textureWaterNormal");
  int textureAtlas=GL20.glGetUniformLocation(ShaderManager.getInstance().getShader("chunk"),"textureAtlas");
  int textureEffects=GL20.glGetUniformLocation(ShaderManager.getInstance().getShader("chunk"),"textureEffects");
  GL20.glUniform1i(lavaTexture,1);
  GL20.glUniform1i(textureWaterNormal,2);
  GL20.glUniform1i(textureEffects,3);
  GL20.glUniform1i(textureAtlas,0);
  boolean playerIsSwimming=_player.isHeadUnderWater();
  ShaderManager.getInstance().enableShader(null);
  PerformanceMonitor.startActivity("BulletPhysicsRenderer");
  BulletPhysicsRenderer.getInstance().render();
  PerformanceMonitor.endActivity();
  ShaderManager.getInstance().enableShader("chunk");
  PerformanceMonitor.startActivity("Chunk-Opaque");
  glEnable(GL_LIGHTING);
  glEnable(GL_LIGHT0);
  for (int i=0; i < _visibleChunks.size(); i++) {
    Chunk c=_visibleChunks.get(i);
    c.render(ChunkMesh.RENDER_PHASE.OPAQUE);
  }
  glDisable(GL_LIGHT0);
  glDisable(GL_LIGHTING);
  PerformanceMonitor.endActivity();
  PerformanceMonitor.startActivity("Chunk-Billboard");
  glEnable(GL_LIGHTING);
  glEnable(GL_LIGHT0);
  glEnable(GL_BLEND);
  glBlendFunc(GL_SRC_ALPHA,GL_ONE_MINUS_SRC_ALPHA);
  for (int i=0; i < _visibleChunks.size(); i++) {
    Chunk c=_visibleChunks.get(i);
    c.render(ChunkMesh.RENDER_PHASE.BILLBOARD_AND_TRANSLUCENT);
  }
  glDisable(GL_LIGHT0);
  glDisable(GL_LIGHTING);
  ShaderManager.getInstance().enableShader(null);
  PerformanceMonitor.endActivity();
  PerformanceMonitor.startActivity("Render Mobs");
  _mobManager.renderAll();
  PerformanceMonitor.endActivity();
  PerformanceMonitor.startActivity("Chunk-WaterIce");
  TextureManager.getInstance().bindTexture("terrain");
  ShaderManager.getInstance().enableShader("chunk");
  if (playerIsSwimming) {
    glDisable(GL11.GL_CULL_FACE);
  }
  glEnable(GL_LIGHTING);
  glEnable(GL_LIGHT0);
  for (int j=0; j < 2; j++) {
    if (j == 0) {
      glColorMask(false,false,false,false);
    }
 else {
      glColorMask(true,true,true,true);
    }
    for (int i=0; i < _visibleChunks.size(); i++) {
      Chunk c=_visibleChunks.get(i);
      c.render(ChunkMesh.RENDER_PHASE.WATER_AND_ICE);
    }
  }
  glDisable(GL_LIGHT0);
  glDisable(GL_LIGHTING);
  glDisable(GL_BLEND);
  glEnable(GL11.GL_CULL_FACE);
  ShaderManager.getInstance().enableShader(null);
  PerformanceMonitor.endActivity();
}
