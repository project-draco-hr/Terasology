{
  if (worldProvider == null)   return;
  BlockComponent blockComp=entity.getComponent(BlockComponent.class);
  Block oldBlock=BlockManager.getInstance().getBlock(worldProvider.getBlock(blockComp.getPosition()));
  worldProvider.setBlock(blockComp.getPosition(),EmptyBlockId,true,true);
  byte upperBlockType=worldProvider.getBlock(blockComp.getPosition().x,blockComp.getPosition().y + 1,blockComp.getPosition().z);
  if (BlockManager.getInstance().getBlock(upperBlockType).getBlockForm() == Block.BLOCK_FORM.BILLBOARD) {
    worldProvider.setBlock(blockComp.getPosition().x,blockComp.getPosition().y + 1,blockComp.getPosition().z,(byte)0x0,true,true);
  }
  AudioManager.play("RemoveBlock",0.6f);
  if ((oldBlock.isStraightToInventory() || oldBlock.isEntityRetainedWhenItem()) && event.getInstigator().exists()) {
    EntityRef item=blockItemFactory.newInstance(oldBlock.getBlockGroup(),(byte)1);
    if (oldBlock.isEntityRetainedWhenItem()) {
      entity.removeComponent(HealthComponent.class);
      entity.removeComponent(BlockComponent.class);
      BlockItemComponent blockItem=item.getComponent(BlockItemComponent.class);
      blockItem.placedEntity=entity;
      item.saveComponent(blockItem);
    }
    if (!inventorySystem.addItem(event.getInstigator(),item)) {
      item.destroy();
      CoreRegistry.get(BulletPhysicsRenderer.class).addLootableBlocks(blockComp.getPosition().toVector3f(),oldBlock);
    }
  }
 else {
    CoreRegistry.get(BulletPhysicsRenderer.class).addLootableBlocks(blockComp.getPosition().toVector3f(),oldBlock);
  }
  if (!oldBlock.isEntityRetainedWhenItem()) {
    entity.destroy();
  }
}
