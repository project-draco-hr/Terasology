{
  if (!loadedIds.contains(entityId)) {
    return;
  }
  EntityRef ref=createEntityRef(entityId);
  if (eventSystem != null) {
    eventSystem.send(ref,BeforeDeactivateComponent.newInstance());
    eventSystem.send(ref,BeforeRemoveComponent.newInstance());
  }
  for (  Component comp : store.iterateComponents(entityId)) {
    notifyComponentRemoved(ref,comp.getClass());
  }
  entityCache.remove(entityId);
  loadedIds.remove(entityId);
  freedIds.add(entityId);
  if (ref instanceof PojoEntityRef) {
    ((PojoEntityRef)ref).invalidate();
  }
  store.remove(entityId);
}
