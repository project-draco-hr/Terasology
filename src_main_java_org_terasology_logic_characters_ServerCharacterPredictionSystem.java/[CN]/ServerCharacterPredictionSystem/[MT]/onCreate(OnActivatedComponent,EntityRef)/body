{
  LocationComponent location=entity.getComponent(LocationComponent.class);
  CharacterMovementComponent movementComp=entity.getComponent(CharacterMovementComponent.class);
  float height=(movementComp.height - 2 * movementComp.radius) * location.getWorldScale();
  float width=movementComp.radius * location.getWorldScale();
  ConvexShape capsule=new CapsuleShape(width,height);
  capsule.setMargin(0.1f);
  movementComp.collider=physics.createCollider(location.getWorldPosition(),capsule,Lists.newArrayList(movementComp.collisionGroup),movementComp.collidesWith,CollisionFlags.CHARACTER_OBJECT);
  movementComp.collider.setUserPointer(entity);
  CircularBuffer<CharacterStateEvent> stateBuffer=CircularBuffer.create(BUFFER_SIZE);
  stateBuffer.add(createInitialState(entity));
  characterStates.put(entity,stateBuffer);
}
