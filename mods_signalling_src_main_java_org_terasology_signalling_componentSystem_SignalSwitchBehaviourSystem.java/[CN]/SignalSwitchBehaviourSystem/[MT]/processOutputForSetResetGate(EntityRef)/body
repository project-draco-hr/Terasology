{
  SignalConsumerAdvancedStatusComponent consumerAdvancedStatusComponent=blockEntity.getComponent(SignalConsumerAdvancedStatusComponent.class);
  EnumSet<Side> signals=SideBitFlag.getSides(consumerAdvancedStatusComponent.sidesWithSignals);
  SignalProducerComponent producerComponent=blockEntity.getComponent(SignalProducerComponent.class);
  int resultSignal=producerComponent.signalStrength;
  if (signals.contains(Side.TOP) || signals.contains(Side.BOTTOM)) {
    resultSignal=0;
  }
 else   if (signals.size() > 0) {
    resultSignal=-1;
  }
  if (producerComponent.signalStrength != resultSignal) {
    producerComponent.signalStrength=resultSignal;
    blockEntity.saveComponent(producerComponent);
    if (resultSignal != 0) {
      if (!blockEntity.hasComponent(SignalProducerModifiedComponent.class)) {
        blockEntity.addComponent(new SignalProducerModifiedComponent());
      }
    }
 else     if (blockEntity.hasComponent(SignalProducerModifiedComponent.class)) {
      blockEntity.removeComponent(SignalProducerModifiedComponent.class);
    }
    return true;
  }
  return false;
}
