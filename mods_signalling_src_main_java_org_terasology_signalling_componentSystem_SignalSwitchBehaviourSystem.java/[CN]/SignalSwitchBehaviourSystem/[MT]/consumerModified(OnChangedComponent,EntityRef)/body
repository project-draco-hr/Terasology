{
  if (entity.hasComponent(BlockComponent.class)) {
    SignalConsumerStatusComponent consumerStatusComponent=entity.getComponent(SignalConsumerStatusComponent.class);
    Vector3i blockLocation=new Vector3i(entity.getComponent(BlockComponent.class).getPosition());
    Block blockAtLocation=worldProvider.getBlock(blockLocation);
    if (blockAtLocation == lampTurnedOff && consumerStatusComponent.hasSignal) {
      logger.info("Lamp turning on");
      worldProvider.setBlock(blockLocation,lampTurnedOn,blockAtLocation);
    }
 else     if (blockAtLocation == lampTurnedOn && !consumerStatusComponent.hasSignal) {
      logger.info("Lamp turning off");
      worldProvider.setBlock(blockLocation,lampTurnedOff,blockAtLocation);
    }
 else     if (blockAtLocation == signalOrGate || blockAtLocation == signalAndGate || blockAtLocation == signalXorGate) {
      SignalProducerComponent producerComponent=entity.getComponent(SignalProducerComponent.class);
      logger.info("Gate has signal: " + consumerStatusComponent.hasSignal);
      if (consumerStatusComponent.hasSignal) {
        producerComponent.signalStrength=-1;
        entity.saveComponent(producerComponent);
        entity.saveComponent(new SignalProducerModifiedComponent());
      }
 else {
        producerComponent.signalStrength=0;
        entity.saveComponent(producerComponent);
        entity.removeComponent(SignalProducerModifiedComponent.class);
      }
    }
 else     if (blockAtLocation == signalNandGate) {
      SignalProducerComponent producerComponent=entity.getComponent(SignalProducerComponent.class);
      logger.info("Gate has signal: " + consumerStatusComponent.hasSignal);
      if (consumerStatusComponent.hasSignal) {
        producerComponent.signalStrength=0;
        entity.saveComponent(producerComponent);
        entity.saveComponent(new SignalProducerModifiedComponent());
      }
 else {
        producerComponent.signalStrength=-1;
        entity.saveComponent(producerComponent);
        entity.removeComponent(SignalProducerModifiedComponent.class);
      }
    }
  }
}
