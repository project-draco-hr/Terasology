{
  if (mode == NetworkMode.NONE) {
    mode=NetworkMode.SERVER;
    for (    EntityRef entity : entityManager.iteratorEntities(NetworkComponent.class)) {
      registerNetworkEntity(entity);
    }
    generateSerializationTables();
    factory=new NioServerSocketChannelFactory(Executors.newCachedThreadPool(),Executors.newCachedThreadPool());
    ServerBootstrap bootstrap=new ServerBootstrap(factory);
    bootstrap.setPipelineFactory(new TerasologyServerPipelineFactory(this));
    bootstrap.setOption("child.tcpNoDelay",true);
    bootstrap.setOption("child.keepAlive",true);
    Channel listenChannel=bootstrap.bind(new InetSocketAddress(port));
    allChannels.add(listenChannel);
    logger.info("Started server");
    nextNetworkTick=timer.getRawTimeInMs();
  }
}
